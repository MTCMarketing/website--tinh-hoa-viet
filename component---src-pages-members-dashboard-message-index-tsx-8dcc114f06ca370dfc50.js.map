{"version":3,"file":"component---src-pages-members-dashboard-message-index-tsx-8dcc114f06ca370dfc50.js","mappings":"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","sources":["webpack:///./node_modules/core-js/internals/to-string.js","webpack:///./src/componets/messaging/UserChat.tsx","webpack:///./src/pages/members/dashboard/message/index.tsx","webpack:///./node_modules/core-js/internals/to-string-tag-support.js","webpack:///./node_modules/core-js/internals/array-method-is-strict.js","webpack:///./node_modules/core-js/internals/environment-webkit-version.js","webpack:///./node_modules/core-js/internals/environment-ff-version.js","webpack:///./node_modules/core-js/internals/environment-is-ie-or-edge.js","webpack:///./node_modules/core-js/internals/array-sort.js","webpack:///./node_modules/core-js/internals/delete-property-or-throw.js","webpack:///./node_modules/core-js/modules/es.array.sort.js","webpack:///./node_modules/core-js/internals/classof.js","webpack:///./node_modules/core-js/internals/array-slice.js"],"sourcesContent":["'use strict';\nvar classof = require('../internals/classof');\n\nvar $String = String;\n\nmodule.exports = function (argument) {\n  if (classof(argument) === 'Symbol') throw new TypeError('Cannot convert a Symbol value to a string');\n  return $String(argument);\n};\n","\"use client\";\n\nimport React, { useState, useEffect, useRef } from \"react\";\nimport { FiSend, FiPaperclip } from \"react-icons/fi\";\nimport { supabase } from \"../../database/supabaseClient\";\n\nexport const UserChat: React.FC = () => {\n  const [message, setMessage] = useState(\"\");\n  const [messages, setMessages] = useState<any[]>([]);\n  const [attachments, setAttachments] = useState<File[]>([]);\n  const [sending, setSending] = useState(false);\n  const [currentUserId, setCurrentUserId] = useState<string | null>(null);\n  const fileInputRef = useRef<HTMLInputElement>(null);\n  const chatEndRef = useRef<HTMLDivElement>(null);\n\n  const ADMIN_ID = \"6c77d859-1af1-418e-b0e0-0d3cc4e80fad\";\n\n  // Load current user id\n  useEffect(() => {\n    supabase.auth.getSession().then(({ data }) => {\n      const uid = data.session?.user?.id ?? null;\n      console.log(\"üë§ User ID:\", uid);\n      setCurrentUserId(uid);\n    });\n  }, []);\n\n  // Fetch ALL messages that involve this user (sent OR received), oldest ‚Üí newest\n  useEffect(() => {\n    const loadMessages = async () => {\n      if (!currentUserId) return;\n      console.log(\"üì¶ Fetching messages for:\", currentUserId);\n\n      const { data, error } = await supabase\n        .from(\"dm_messages\")\n        .select(\"*\")\n        .or(`sender_id.eq.${currentUserId},recipient_id.eq.${currentUserId}`)\n        .order(\"created_at\", { ascending: true });\n\n      if (error) {\n        console.error(\"‚ùå Fetch failed:\", error.message);\n        return;\n      }\n      console.log(`‚úÖ Loaded ${data.length} messages`);\n      setMessages(data);\n    };\n\n    loadMessages();\n  }, [currentUserId]);\n\n  // Realtime listener: any INSERT, add if it involves this user\n  useEffect(() => {\n    if (!currentUserId) return;\n\n    console.log(\"üëÇ Listening for realtime messages involving:\", currentUserId);\n\n    const channel = supabase\n      .channel(`dm_stream_user_${currentUserId}`)\n      .on(\n        \"postgres_changes\",\n        {\n          event: \"INSERT\",\n          schema: \"public\",\n          table: \"dm_messages\",\n        },\n        (payload) => {\n          const msg = payload.new as any;\n          // Only show if I'm sender or recipient (RLS already restricts delivery)\n          if (msg.sender_id === currentUserId || msg.recipient_id === currentUserId) {\n            setMessages((prev) => {\n              if (prev.some((m) => m.id === msg.id)) return prev;\n              const next = [...prev, msg].sort(\n                (a, b) => new Date(a.created_at).getTime() - new Date(b.created_at).getTime()\n              );\n              return next;\n            });\n            // auto-scroll\n            setTimeout(() => chatEndRef.current?.scrollIntoView({ behavior: \"smooth\" }), 0);\n          }\n        }\n      )\n      .subscribe((status) => console.log(\"üì° Channel status:\", status));\n\n    return () => {\n      console.log(\"üßπ Unsubscribing...\");\n      supabase.removeChannel(channel);\n    };\n  }, [currentUserId]);\n\n  // Auto-scroll on initial/updates\n  useEffect(() => {\n    chatEndRef.current?.scrollIntoView({ behavior: \"smooth\" });\n  }, [messages]);\n\n  const handleAttach = (e: React.ChangeEvent<HTMLInputElement>) => {\n    if (e.target.files) {\n      const newFiles = Array.from(e.target.files);\n      setAttachments((prev) => [...prev, ...newFiles]);\n    }\n  };\n\n  // Send (user ‚Üí admin)\n  const handleSend = async () => {\n    if (!message.trim() || !currentUserId) return;\n\n    setSending(true);\n    try {\n      const { data: session } = await supabase.auth.getSession();\n      const sender = session?.session?.user;\n      if (!sender) throw new Error(\"Not logged in\");\n\n      console.log(\"üßæ Insert payload:\", {\n        sender_id: sender.id,\n        message,\n        recipient_id: ADMIN_ID,\n      });\n\n      const { data, error } = await supabase\n        .from(\"dm_messages\")\n        .insert([\n          {\n            sender_id: sender.id,\n            message,\n            recipient_id: ADMIN_ID,\n          },\n        ])\n        .select();\n\n      if (error) console.error(\"üî• Supabase insert error:\", error);\n\n      if (data && data[0]) {\n        // Optimistic append at bottom\n        setMessages((prev) => [...prev, data[0]]);\n        setMessage(\"\");\n        setAttachments([]);\n        setTimeout(() => chatEndRef.current?.scrollIntoView({ behavior: \"smooth\" }), 0);\n      }\n    } catch (err: any) {\n      console.error(\"‚ùå Send failed:\", err.message);\n    } finally {\n      setSending(false);\n    }\n  };\n\n  // UI\n  return (\n    <div style={{ display: \"flex\", flexDirection: \"column\", height: \"100vh\", background: \"#f9fafb\", color: \"#111827\" }}>\n      {/* Current user id */}\n      <div style={{ background: \"#e2e8f0\", color: \"#1e293b\", fontSize: \"12px\", padding: \"6px 12px\", borderBottom: \"1px solid #cbd5e1\" }}>\n        üë§ <strong>Current User ID:</strong> {currentUserId ?? \"Loading‚Ä¶ (no session yet)\"}\n      </div>\n\n      <div style={{ flexGrow: 1, overflowY: \"auto\", padding: \"20px\", paddingBottom: \"100px\" }}>\n        {messages.map((msg) => {\n          const isOutbound = msg.sender_id === currentUserId;\n          return (\n            <div key={msg.id} style={{ display: \"flex\", justifyContent: isOutbound ? \"flex-end\" : \"flex-start\", marginBottom: \"10px\" }}>\n              <div\n                style={{\n                  background: isOutbound ? \"#00838F\" : \"#E2E8F0\",\n                  color: isOutbound ? \"white\" : \"#1E293B\",\n                  borderRadius: \"12px\",\n                  padding: \"10px 14px\",\n                  maxWidth: \"70%\",\n                  wordBreak: \"break-word\",\n                }}\n              >\n                <div style={{ fontSize: \"14px\" }}>{msg.message}</div>\n                <div style={{ fontSize: \"11px\", marginTop: \"4px\", opacity: 0.6, textAlign: isOutbound ? \"right\" : \"left\" }}>\n                  {new Date(msg.created_at).toLocaleTimeString([], { hour: \"2-digit\", minute: \"2-digit\" })}\n                </div>\n              </div>\n            </div>\n          );\n        })}\n        <div ref={chatEndRef} />\n      </div>\n\n      {/* Sticky Footer */}\n      <div\n        style={{\n          position: \"sticky\",\n          bottom: 0,\n          background: \"#fff\",\n          borderTop: \"1px solid #e5e7eb\",\n          padding: \"12px 20px\",\n          display: \"flex\",\n          alignItems: \"center\",\n          gap: \"10px\",\n        }}\n      >\n        <button onClick={() => fileInputRef.current?.click()} style={{ background: \"none\", border: \"none\", color: \"#0369a1\", cursor: \"pointer\" }}>\n          <FiPaperclip size={18} />\n        </button>\n\n        <input type=\"file\" ref={fileInputRef} multiple onChange={handleAttach} style={{ display: \"none\" }} />\n\n        <input\n          value={message}\n          onChange={(e) => setMessage(e.target.value)}\n          placeholder=\"Type your message...\"\n          style={{ flexGrow: 1, borderRadius: \"8px\", border: \"1px solid #d1d5db\", padding: \"10px\", fontSize: \"14px\" }}\n          onKeyDown={(e) => {\n            if (e.key === \"Enter\" && !e.shiftKey) {\n              e.preventDefault();\n              handleSend();\n            }\n          }}\n        />\n\n        <button\n          onClick={handleSend}\n          disabled={sending}\n          style={{\n            background: \"#00838F\",\n            color: \"white\",\n            border: \"none\",\n            borderRadius: \"8px\",\n            padding: \"10px 14px\",\n            fontWeight: 500,\n            cursor: \"pointer\",\n            opacity: sending ? 0.8 : 1,\n            display: \"flex\",\n            alignItems: \"center\",\n            gap: \"6px\",\n          }}\n        >\n          <FiSend size={18} />\n        </button>\n      </div>\n    </div>\n  );\n};\n","import React from \"react\";\nimport SendMessage from \"../../../../componets/cms/SendMessage\";\nimport { SendDirectMessage } from \"../../../../componets/messaging/SendDirectMessage\";\nimport { UserChat } from \"../../../../componets/messaging/UserChat\";\n\n\nexport default () => <UserChat/>;","'use strict';\nvar wellKnownSymbol = require('../internals/well-known-symbol');\n\nvar TO_STRING_TAG = wellKnownSymbol('toStringTag');\nvar test = {};\n// eslint-disable-next-line unicorn/no-immediate-mutation -- ES3 syntax limitation\ntest[TO_STRING_TAG] = 'z';\n\nmodule.exports = String(test) === '[object z]';\n","'use strict';\nvar fails = require('../internals/fails');\n\nmodule.exports = function (METHOD_NAME, argument) {\n  var method = [][METHOD_NAME];\n  return !!method && fails(function () {\n    // eslint-disable-next-line no-useless-call -- required for testing\n    method.call(null, argument || function () { return 1; }, 1);\n  });\n};\n","'use strict';\nvar userAgent = require('../internals/environment-user-agent');\n\nvar webkit = userAgent.match(/AppleWebKit\\/(\\d+)\\./);\n\nmodule.exports = !!webkit && +webkit[1];\n","'use strict';\nvar userAgent = require('../internals/environment-user-agent');\n\nvar firefox = userAgent.match(/firefox\\/(\\d+)/i);\n\nmodule.exports = !!firefox && +firefox[1];\n","'use strict';\nvar UA = require('../internals/environment-user-agent');\n\nmodule.exports = /MSIE|Trident/.test(UA);\n","'use strict';\nvar arraySlice = require('../internals/array-slice');\n\nvar floor = Math.floor;\n\nvar sort = function (array, comparefn) {\n  var length = array.length;\n\n  if (length < 8) {\n    // insertion sort\n    var i = 1;\n    var element, j;\n\n    while (i < length) {\n      j = i;\n      element = array[i];\n      while (j && comparefn(array[j - 1], element) > 0) {\n        array[j] = array[--j];\n      }\n      if (j !== i++) array[j] = element;\n    }\n  } else {\n    // merge sort\n    var middle = floor(length / 2);\n    var left = sort(arraySlice(array, 0, middle), comparefn);\n    var right = sort(arraySlice(array, middle), comparefn);\n    var llength = left.length;\n    var rlength = right.length;\n    var lindex = 0;\n    var rindex = 0;\n\n    while (lindex < llength || rindex < rlength) {\n      array[lindex + rindex] = (lindex < llength && rindex < rlength)\n        ? comparefn(left[lindex], right[rindex]) <= 0 ? left[lindex++] : right[rindex++]\n        : lindex < llength ? left[lindex++] : right[rindex++];\n    }\n  }\n\n  return array;\n};\n\nmodule.exports = sort;\n","'use strict';\nvar tryToString = require('../internals/try-to-string');\n\nvar $TypeError = TypeError;\n\nmodule.exports = function (O, P) {\n  if (!delete O[P]) throw new $TypeError('Cannot delete property ' + tryToString(P) + ' of ' + tryToString(O));\n};\n","'use strict';\nvar $ = require('../internals/export');\nvar uncurryThis = require('../internals/function-uncurry-this');\nvar aCallable = require('../internals/a-callable');\nvar toObject = require('../internals/to-object');\nvar lengthOfArrayLike = require('../internals/length-of-array-like');\nvar deletePropertyOrThrow = require('../internals/delete-property-or-throw');\nvar toString = require('../internals/to-string');\nvar fails = require('../internals/fails');\nvar internalSort = require('../internals/array-sort');\nvar arrayMethodIsStrict = require('../internals/array-method-is-strict');\nvar FF = require('../internals/environment-ff-version');\nvar IE_OR_EDGE = require('../internals/environment-is-ie-or-edge');\nvar V8 = require('../internals/environment-v8-version');\nvar WEBKIT = require('../internals/environment-webkit-version');\n\nvar test = [];\nvar nativeSort = uncurryThis(test.sort);\nvar push = uncurryThis(test.push);\n\n// IE8-\nvar FAILS_ON_UNDEFINED = fails(function () {\n  test.sort(undefined);\n});\n// V8 bug\nvar FAILS_ON_NULL = fails(function () {\n  test.sort(null);\n});\n// Old WebKit\nvar STRICT_METHOD = arrayMethodIsStrict('sort');\n\nvar STABLE_SORT = !fails(function () {\n  // feature detection can be too slow, so check engines versions\n  if (V8) return V8 < 70;\n  if (FF && FF > 3) return;\n  if (IE_OR_EDGE) return true;\n  if (WEBKIT) return WEBKIT < 603;\n\n  var result = '';\n  var code, chr, value, index;\n\n  // generate an array with more 512 elements (Chakra and old V8 fails only in this case)\n  for (code = 65; code < 76; code++) {\n    chr = String.fromCharCode(code);\n\n    switch (code) {\n      case 66: case 69: case 70: case 72: value = 3; break;\n      case 68: case 71: value = 4; break;\n      default: value = 2;\n    }\n\n    for (index = 0; index < 47; index++) {\n      test.push({ k: chr + index, v: value });\n    }\n  }\n\n  test.sort(function (a, b) { return b.v - a.v; });\n\n  for (index = 0; index < test.length; index++) {\n    chr = test[index].k.charAt(0);\n    if (result.charAt(result.length - 1) !== chr) result += chr;\n  }\n\n  return result !== 'DGBEFHACIJK';\n});\n\nvar FORCED = FAILS_ON_UNDEFINED || !FAILS_ON_NULL || !STRICT_METHOD || !STABLE_SORT;\n\nvar getSortCompare = function (comparefn) {\n  return function (x, y) {\n    if (y === undefined) return -1;\n    if (x === undefined) return 1;\n    if (comparefn !== undefined) return +comparefn(x, y) || 0;\n    return toString(x) > toString(y) ? 1 : -1;\n  };\n};\n\n// `Array.prototype.sort` method\n// https://tc39.es/ecma262/#sec-array.prototype.sort\n$({ target: 'Array', proto: true, forced: FORCED }, {\n  sort: function sort(comparefn) {\n    if (comparefn !== undefined) aCallable(comparefn);\n\n    var array = toObject(this);\n\n    if (STABLE_SORT) return comparefn === undefined ? nativeSort(array) : nativeSort(array, comparefn);\n\n    var items = [];\n    var arrayLength = lengthOfArrayLike(array);\n    var itemsLength, index;\n\n    for (index = 0; index < arrayLength; index++) {\n      if (index in array) push(items, array[index]);\n    }\n\n    internalSort(items, getSortCompare(comparefn));\n\n    itemsLength = lengthOfArrayLike(items);\n    index = 0;\n\n    while (index < itemsLength) array[index] = items[index++];\n    while (index < arrayLength) deletePropertyOrThrow(array, index++);\n\n    return array;\n  }\n});\n","'use strict';\nvar TO_STRING_TAG_SUPPORT = require('../internals/to-string-tag-support');\nvar isCallable = require('../internals/is-callable');\nvar classofRaw = require('../internals/classof-raw');\nvar wellKnownSymbol = require('../internals/well-known-symbol');\n\nvar TO_STRING_TAG = wellKnownSymbol('toStringTag');\nvar $Object = Object;\n\n// ES3 wrong here\nvar CORRECT_ARGUMENTS = classofRaw(function () { return arguments; }()) === 'Arguments';\n\n// fallback for IE11 Script Access Denied error\nvar tryGet = function (it, key) {\n  try {\n    return it[key];\n  } catch (error) { /* empty */ }\n};\n\n// getting tag from ES6+ `Object.prototype.toString`\nmodule.exports = TO_STRING_TAG_SUPPORT ? classofRaw : function (it) {\n  var O, tag, result;\n  return it === undefined ? 'Undefined' : it === null ? 'Null'\n    // @@toStringTag case\n    : typeof (tag = tryGet(O = $Object(it), TO_STRING_TAG)) == 'string' ? tag\n    // builtinTag case\n    : CORRECT_ARGUMENTS ? classofRaw(O)\n    // ES3 arguments fallback\n    : (result = classofRaw(O)) === 'Object' && isCallable(O.callee) ? 'Arguments' : result;\n};\n","'use strict';\nvar uncurryThis = require('../internals/function-uncurry-this');\n\nmodule.exports = uncurryThis([].slice);\n"],"names":["classof","$String","String","module","exports","argument","TypeError","UserChat","message","setMessage","useState","messages","setMessages","attachments","setAttachments","sending","setSending","currentUserId","setCurrentUserId","fileInputRef","useRef","chatEndRef","ADMIN_ID","useEffect","supabase","auth","getSession","then","_ref","data","uid","session","_data$session","user","_data$session$user","id","console","log","async","error","from","select","or","order","ascending","length","loadMessages","channel","on","event","schema","table","payload","msg","new","sender_id","recipient_id","prev","some","m","sort","a","b","Date","created_at","getTime","setTimeout","current","_chatEndRef$current","scrollIntoView","behavior","subscribe","status","removeChannel","_chatEndRef$current2","handleSend","trim","sender","_session$session","Error","insert","_chatEndRef$current3","err","React","style","display","flexDirection","height","background","color","fontSize","padding","borderBottom","flexGrow","overflowY","paddingBottom","map","isOutbound","key","justifyContent","marginBottom","borderRadius","maxWidth","wordBreak","marginTop","opacity","textAlign","toLocaleTimeString","hour","minute","ref","position","bottom","borderTop","alignItems","gap","onClick","_fileInputRef$current","click","border","cursor","FiPaperclip","size","type","multiple","onChange","e","target","files","newFiles","Array","value","placeholder","onKeyDown","shiftKey","preventDefault","disabled","fontWeight","FiSend","test","wellKnownSymbol","fails","METHOD_NAME","method","call","webkit","match","firefox","UA","arraySlice","floor","Math","array","comparefn","element","j","i","middle","left","right","llength","rlength","lindex","rindex","tryToString","$TypeError","O","P","$","uncurryThis","aCallable","toObject","lengthOfArrayLike","deletePropertyOrThrow","toString","internalSort","arrayMethodIsStrict","FF","IE_OR_EDGE","V8","WEBKIT","nativeSort","push","FAILS_ON_UNDEFINED","undefined","FAILS_ON_NULL","STRICT_METHOD","STABLE_SORT","code","chr","index","result","fromCharCode","k","v","charAt","proto","forced","this","itemsLength","items","arrayLength","x","y","getSortCompare","TO_STRING_TAG_SUPPORT","isCallable","classofRaw","TO_STRING_TAG","$Object","Object","CORRECT_ARGUMENTS","arguments","it","tag","tryGet","callee","slice"],"sourceRoot":""}