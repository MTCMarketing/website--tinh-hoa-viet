"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[9076],{8426:function(e,t,a){a.r(t),a.d(t,{default:function(){return c}});var o=a(5458),n=a(6540),s=a(6898);function r(){const e=Object.keys(localStorage);let t=!1;return e.forEach(e=>{if("sb-sb-auth-token"===e||e.includes("undefined")||e.includes("null")||e.startsWith("sb-")&&!e.includes("-auth-token"))console.warn("ğŸ›‘ Deleting corrupted key:",e),localStorage.removeItem(e),t=!0;else if(e.startsWith("sb-"))try{JSON.parse(localStorage.getItem(e)||"")}catch(a){console.warn("ğŸ›‘ Invalid JSON in:",e),localStorage.removeItem(e),t=!0}}),t}function i(){Object.keys(localStorage).forEach(e=>{e.startsWith("sb-")&&(console.warn("ğŸ’£ Removing Supabase key:",e),localStorage.removeItem(e))})}const l=[{label:"User1",email:"user1@test.com",password:"password1"},{label:"User2",email:"user2@test.com",password:"password1"}];function c(){const{0:e,1:t}=(0,n.useState)([]),a=e=>t(t=>[].concat((0,o.A)(t),["["+(new Date).toLocaleTimeString()+"] "+e]));return n.createElement("div",{style:{padding:20,color:"white",background:"#111",fontFamily:"monospace",minHeight:"100vh"}},n.createElement("h1",null,"ğŸ§ª Supabase Auth Debugger"),n.createElement("p",null,"Use this page to break, inspect, repair, and test Supabase auth."),n.createElement("h2",null,"ğŸ”§ Actions"),n.createElement("div",{style:{display:"flex",gap:10,flexWrap:"wrap"}},n.createElement("button",{onClick:()=>{!function(){console.warn("ğŸ’¥ Simulating REAL corruption (race condition)â€¦");const e={currentSession:{expires_at:Date.now()/1e3+3600,access_token:"FOO",refresh_token:"BAR"},expiresAt:Date.now()+3600};localStorage.setItem("sb-sb-auth-token",JSON.stringify(e)),setTimeout(()=>{console.warn("ğŸ’¥ Injecting half-written sessionâ€¦"),localStorage.setItem("sb-sb-auth-token","{bad_json:")},5),setTimeout(()=>{console.warn("ğŸ’£ Login page wiping keys at same momentâ€¦"),localStorage.removeItem("sb-sb-auth-token")},5)}(),a("ğŸ’¥ Created corrupted Supabase storage entries.")}},"ğŸ’¥ Corrupt Storage"),n.createElement("button",{onClick:()=>{const e=r();a(e?"ğŸ›  Repaired storage!":"ğŸ‘Œ Nothing to repair.")}},"ğŸ›  Repair Storage"),n.createElement("button",{onClick:()=>{i(),a("ğŸ’£ Nuked all Supabase storage keys.")}},"ğŸ’£ Nuke Storage"),n.createElement("button",{onClick:()=>{a("ğŸ“¦ Current localStorage:"),a(JSON.stringify(Object.keys(localStorage),null,2))}},"ğŸ“¦ Inspect Storage"),n.createElement("button",{onClick:async()=>{a("ğŸ” Fetching sessionâ€¦");const{data:e,error:t}=await s.ND.auth.getSession();t&&a("âŒ "+t.message),a(JSON.stringify(e,null,2))}},"ğŸ” Get Session"),n.createElement("button",{onClick:async()=>{a("ğŸšª Logout test startedâ€¦"),i();const{error:e}=await s.ND.auth.signOut();a(e?"âŒ Logout failed: "+e.message:"âœ… Successfully logged out and wiped storage.")}},"ğŸšª Logout"),n.createElement("button",{onClick:()=>{a("â³ Setting auto-repair timer (5s)â€¦"),setTimeout(()=>{const e=r();a(e?"ğŸ›  Timer repair executed":"ğŸ‘Œ Timer found no corruption")},5e3)}},"â³ Timed Repair")),n.createElement("h2",null,"ğŸ” Login Tests"),n.createElement("div",{style:{display:"flex",gap:10,flexWrap:"wrap"}},l.map(e=>n.createElement("button",{key:e.label,onClick:()=>(async e=>{a("\n=== ğŸ” LOGIN TEST ("+e.label+") ===");const{error:t}=await s.ND.auth.signInWithPassword({email:e.email,password:e.password});if(t)return void a("âŒ Login error: "+t.message);a("âœ… Logged in as "+e.email);const{data:o}=await s.ND.auth.getSession();a("ğŸ“¦ Session after login:"),a(JSON.stringify(o,null,2))})(e)},"Login as ",e.label))),n.createElement("pre",{style:{marginTop:20,background:"#000",padding:15,borderRadius:8,height:500,overflowY:"auto",fontSize:12}},e.join("\n")))}}}]);
//# sourceMappingURL=component---src-pages-test-auth-corruption-tsx-81d49b171fb2a25e978e.js.map