{"version":3,"file":"component---src-pages-portal-test-tsx-8c1fc542119a4cd9d1ff.js","mappings":"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","sources":["webpack:///./src/pages/portal-test.tsx"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport '../componets/log-in/login.css';\nimport { FiArrowRight, FiCheckCircle } from 'react-icons/fi';\nimport { supabase } from '../database/supabaseClient';\n\nconst i18n = {\n  EN: {\n    brandTitle: 'TINH HOA VI·ªÜT',\n    tagline: 'Where Vietnamese Excellence Meets Global Recognition',\n    features: ['Exclusive Gala Event', 'Cultural Performances', 'Networking with Honorees'],\n    title: 'Event Ticket Payment',\n    subtitle: 'Complete your payment to confirm your attendance',\n    eventName: 'Vietnamese Excellence Gala 2025',\n    date: 'December 10, 2025 ‚Äì 7:00 PM',\n    location: 'Saigon Opera House, Ho Chi Minh City',\n    price: 'Ticket Price: 500,000‚Ç´',\n    payBtn: 'Pay Now',\n    loading: 'Processing payment...',\n    success: 'Payment Confirmed! Thank you.',\n    testBtn: 'Test Portal Payment',\n    langEN: 'EN',\n    langVN: 'VN'\n  },\n  VN: {\n    brandTitle: 'TINH HOA VI·ªÜT',\n    tagline: 'N∆°i t√¥n vinh tinh hoa Vi·ªát Nam v∆∞∆°n t·∫ßm qu·ªëc t·∫ø',\n    features: ['S·ª± ki·ªán Gala ƒë·ªôc quy·ªÅn', 'Bi·ªÉu di·ªÖn vƒÉn h√≥a', 'K·∫øt n·ªëi c√πng c√°c tinh hoa'],\n    title: 'Thanh To√°n V√© S·ª± Ki·ªán',\n    subtitle: 'Ho√†n t·∫•t thanh to√°n ƒë·ªÉ x√°c nh·∫≠n tham d·ª±',\n    eventName: 'Gala Tinh Hoa Vi·ªát 2025',\n    date: '10/12/2025 ‚Äì 19:00',\n    location: 'Nh√† h√°t Th√†nh ph·ªë, TP. H·ªì Ch√≠ Minh',\n    price: 'Gi√° v√©: 500,000‚Ç´',\n    payBtn: 'Thanh to√°n ngay',\n    loading: 'ƒêang x·ª≠ l√Ω thanh to√°n...',\n    success: 'Thanh to√°n th√†nh c√¥ng! C·∫£m ∆°n b·∫°n.',\n    testBtn: 'Ki·ªÉm tra thanh to√°n (Portal)',\n    langEN: 'EN',\n    langVN: 'VN'\n  }\n};\n\nconst EventPayment: React.FC = () => {\n  const [language, setLanguage] = useState<'EN' | 'VN'>('EN');\n  const [loading, setLoading] = useState(false);\n  const [isPaid, setIsPaid] = useState(false);\n  const [user, setUser] = useState<any>(null);\n  const [qrData, setQrData] = useState<any>(null);\n  const t = i18n[language];\n\n  useEffect(() => {\n    supabase.auth.getUser().then(({ data }) => {\n      if (data?.user) setUser(data.user);\n    });\n  }, []);\n\n  // === Create VietQR Payment Intent ===\n  const handlePayment = async () => {\n    if (!user) {\n      alert('Please log in first.');\n      return;\n    }\n\n    const endpoint = 'https://integrations.tinhhoaviet.org.vn/vietqr/payment-intent';\n\n    try {\n      setLoading(true);\n      const res = await fetch(endpoint, {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify({ user_id: user.id }),\n      });\n\n      if (!res.ok) throw new Error('Payment request failed.');\n      const data = await res.json();\n\n      console.log('üí≥ VietQR API Response:', data);\n\n      if (data.qrLink) {\n        setQrData(data); // store the VietQR response\n        window.open(data.qrLink, '_blank');\n      } else {\n        alert('Payment link not received.');\n        setIsPaid(true);\n      }\n    } catch (err) {\n      console.error('‚ùå Payment Error:', err);\n      alert('An error occurred while initiating payment.');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  // === Test Payment Simulation ===\n  const handleTestPayment = async () => {\n    if (!qrData) {\n      alert('No QR data available.');\n      return;\n    }\n\n    // Build payload2 dynamically\n    const payload2 = {\n      bankAccount: qrData.bankAccount,\n      content: qrData.content,\n      amount: qrData.amount,\n      bankCode: qrData.bankCode,\n      transType: 'C',\n    };\n\n    console.log('üßæ Sending payload2:', payload2);\n\n    try {\n      const res = await fetch('https://integrations.tinhhoaviet.org.vn/vietqr/test-success', {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify(payload2),\n      });\n\n      const result = await res.text();\n      console.log('‚úÖ Response from test-success:', result);\n    } catch (err) {\n      console.error('‚ùå Failed to post to /vietqr/test-success:', err);\n    }\n  };\n\n  return (\n    <div className=\"auth-shell\">\n      {/* Left branding panel */}\n      <aside className=\"brand-side\">\n        <div className=\"brand-sheen\" />\n        <div className=\"brand-pattern\" />\n        <div className=\"brand-wrap\">\n          <h1 className=\"brand-name\">{t.brandTitle}</h1>\n          <p className=\"brand-tag\">{t.tagline}</p>\n          <ul className=\"brand-features\">\n            {t.features.map((f, i) => (\n              <li key={i} className=\"feature\">\n                <span className=\"tick\">‚úì</span><span>{f}</span>\n              </li>\n            ))}\n          </ul>\n        </div>\n      </aside>\n\n      {/* Right form side */}\n      <main className=\"form-side\">\n        <header className=\"form-top\">\n          <div className=\"lang-switch\">\n            <button\n              className={`lang ${language === 'EN' ? 'active' : ''}`}\n              onClick={() => setLanguage('EN')}\n            >\n              {t.langEN}\n            </button>\n            <span className=\"mid\">|</span>\n            <button\n              className={`lang ${language === 'VN' ? 'active' : ''}`}\n              onClick={() => setLanguage('VN')}\n            >\n              {t.langVN}\n            </button>\n          </div>\n        </header>\n\n        <section className=\"form-wrap\" style={{ color: 'var(--ink)' }}>\n          <div className=\"intro\">\n            <h2 className=\"title\">{t.title}</h2>\n            <p className=\"subtitle\">{t.subtitle}</p>\n          </div>\n\n          <div className=\"auth-form\" style={{ textAlign: 'center', color: 'var(--ink)' }}>\n            <div className=\"field\">\n              <h3 style={{ color: 'var(--gold-2)', fontSize: 22, marginBottom: 6 }}>\n                {t.eventName}\n              </h3>\n              <p>{t.date}</p>\n              <p>{t.location}</p>\n              <p style={{ fontWeight: 700, marginTop: 10 }}>{t.price}</p>\n            </div>\n\n            {/* Dynamic Button Behavior */}\n            {!qrData ? (\n              <button\n                className=\"cta\"\n                onClick={handlePayment}\n                disabled={loading || !user}\n                style={{\n                  opacity: loading || !user ? 0.6 : 1,\n                  cursor: !user ? 'not-allowed' : 'pointer',\n                }}\n              >\n                <span>\n                  {!user\n                    ? 'Login required'\n                    : loading\n                    ? t.loading\n                    : t.payBtn}\n                </span>\n                {!loading && user && <FiArrowRight className=\"arrow\" />}\n              </button>\n            ) : (\n              <button\n                className=\"cta\"\n                onClick={handleTestPayment}\n                style={{ backgroundColor: '#00b37a' }}\n              >\n                {t.testBtn}\n              </button>\n            )}\n\n            {isPaid && (\n              <div\n                style={{\n                  marginTop: 20,\n                  color: 'var(--gold-2)',\n                  fontWeight: 700,\n                  display: 'flex',\n                  justifyContent: 'center',\n                  alignItems: 'center',\n                  gap: 8,\n                }}\n              >\n                <FiCheckCircle size={22} />\n                {t.success}\n              </div>\n            )}\n          </div>\n        </section>\n      </main>\n    </div>\n  );\n};\n\nexport default EventPayment;\n"],"names":["i18n","EN","brandTitle","tagline","features","title","subtitle","eventName","date","location","price","payBtn","loading","success","testBtn","langEN","langVN","VN","EventPayment","language","setLanguage","useState","setLoading","isPaid","setIsPaid","user","setUser","qrData","setQrData","t","useEffect","supabase","auth","getUser","then","_ref","data","React","className","map","f","i","key","onClick","style","color","textAlign","fontSize","marginBottom","fontWeight","marginTop","async","alert","payload2","bankAccount","content","amount","bankCode","transType","console","log","res","fetch","method","headers","body","JSON","stringify","result","text","err","error","backgroundColor","user_id","id","ok","Error","json","qrLink","window","open","disabled","opacity","cursor","FiArrowRight","display","justifyContent","alignItems","gap","FiCheckCircle","size"],"sourceRoot":""}