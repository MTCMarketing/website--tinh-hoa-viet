"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[2057],{2479:function(e,t,n){var l=n(6540),r=n(6898),o=n(5268);t.A=e=>{let{children:t,role:n="member",redirect:a="/members/dashboard"}=e;const{0:s,1:i}=(0,l.useState)(null),{0:c,1:u}=(0,l.useState)(null),{0:d,1:m}=(0,l.useState)(!0),{0:f,1:g}=(0,l.useState)(!1);(0,l.useEffect)(()=>{(async()=>{m(!0);try{var e,t;const{data:l}=await r.ND.auth.getSession(),a=l.session;if(i(a),null==a||!a.user)return(0,o.navigate)("/sign-in"),g(!1),void u(null);const s=null!==(e=null===(t=a.user.user_metadata)||void 0===t?void 0:t.role)&&void 0!==e?e:"member";if(u(s),"string"==typeof n)g(s===n||"member"===n&&!!s);else{const e=n[s];g(!!e)}}catch(l){console.error("RoleRoutes check error:",l),g(!1)}finally{m(!1)}})()},[n]);const p={allowed:f,loading:d,session:s,role:c};return"function"==typeof t?l.createElement(l.Fragment,null,t(p)):((0,l.useEffect)(()=>{if(!d&&c)if("string"==typeof n)f||(0,o.navigate)(a);else{const e=n[c];e?!f&&e.onFalse?(0,o.navigate)(e.onFalse):f&&e.onTrue&&(0,o.navigate)(e.onTrue):(0,o.navigate)(a)}},[d,f,c,n,a]),d?null:f||"string"!=typeof n?l.createElement(l.Fragment,null,t):null)}},7491:function(e,t,n){n.r(t),n.d(t,{default:function(){return s}});var l=n(6540),r=n(6898),o=n(2479);function a(){const[e,t]=l.useState(null);return l.useEffect(()=>{(async e=>{const{data:n}=await r.ND.auth.getSession(),l=n.session;if(!l)return void t("No active session");const{data:o}=await r.ND.from("user_private").select("role").eq("id",l.user.id).single();t({email:l.user.email,id:l.user.id,role:null!==(e=null==o?void 0:o.role)&&void 0!==e?e:"(none)"})})()},[]),l.createElement("div",{style:{background:"#111",color:"#0f0",padding:12,borderRadius:6,fontFamily:"monospace",marginTop:20}},l.createElement("strong",null,"SESSION DEBUG"),l.createElement("pre",{style:{whiteSpace:"pre-wrap",fontSize:12}},JSON.stringify(e,null,2)))}function s(){const e=(e,t,n)=>e=>{let{loading:r,allowed:o,role:a}=e;return l.createElement("div",{style:{background:o?t:r?"#fffad6":"#ffe7e7",padding:20,borderRadius:8,color:o?n:r?"#aa7700":"#880000",border:o?"2px solid "+n:r?"2px solid #cca300":"2px solid #f33",fontWeight:"bold",transition:"all 0.3s ease"}},r?"â³ Checking access...":o?"âœ… Youâ€™re allowed to see this because your role matches (â€œ"+a+"â€).":"âŒ Access denied â€” current role: â€œ"+(null!=a?a:"none")+"â€.")};return l.createElement("div",{style:{background:"#fff",color:"#000",minHeight:"100vh",fontFamily:"system-ui, sans-serif",padding:20}},l.createElement("h1",null,"ğŸ§© RoleRoutes Integration Test"),l.createElement("p",{style:{marginBottom:20}},"This page mounts the ",l.createElement("code",null,"<RoleRoutes>")," component directly. It will fetch your Supabase session, determine your role, and show the correct access state for each role test."),l.createElement("section",{style:{border:"2px solid #ccc",padding:16,borderRadius:8,marginBottom:30}},l.createElement("h2",null,"ğŸ‘¤ Member Test"),l.createElement(o.A,{role:"member"},e(0,"#e7ffe7","#005500"))),l.createElement("section",{style:{border:"2px solid #ccc",padding:16,borderRadius:8,marginBottom:30}},l.createElement("h2",null,"ğŸ›¡ï¸ Admin Test"),l.createElement(o.A,{role:"admin"},e(0,"#ffe7e7","#880000"))),l.createElement("section",{style:{border:"2px solid #ccc",padding:16,borderRadius:8}},l.createElement("h2",null,"ğŸªª Authenticator Test"),l.createElement(o.A,{role:"authenticator"},e(0,"#e7f0ff","#004488"))),l.createElement(a,null),l.createElement("div",{style:{marginTop:40,padding:16,borderTop:"1px solid #ddd",color:"#444",fontSize:14}},l.createElement("h3",null,"â„¹ï¸ How this test works"),l.createElement("p",null,"Each section mounts the real ",l.createElement("code",null,"<RoleRoutes>")," wrapper with a different required role."),l.createElement("ul",{style:{marginTop:6}},l.createElement("li",null,"âœ… Green box â†’ access granted"),l.createElement("li",null,"âŒ Red box â†’ access denied"),l.createElement("li",null,"â³ Yellow box â†’ still checking"))))}}}]);
//# sourceMappingURL=component---src-pages-test-role-based-routes-tsx-f4a29312fd0aff344dfc.js.map