"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[9157],{373:function(e,t,r){var n=r(4576),o=r(7476),a=r(9039),i=r(9306),u=r(4488),c=r(4644),s=r(3709),l=r(3763),p=r(9519),f=r(3607),d=c.aTypedArray,y=c.exportTypedArrayMethod,h=n.Uint16Array,m=h&&o(h.prototype.sort),g=!(!m||a(function(){m(new h(2),null)})&&a(function(){m(new h(2),{})})),v=!!m&&!a(function(){if(p)return p<74;if(s)return s<67;if(l)return!0;if(f)return f<602;var e,t,r=new h(516),n=Array(516);for(e=0;e<516;e++)t=e%4,r[e]=515-e,n[e]=e-2*t+3;for(m(r,function(e,t){return(e/4|0)-(t/4|0)}),e=0;e<516;e++)if(r[e]!==n[e])return!0});y("sort",function(e){return void 0!==e&&i(e),v?m(this,e):u(d(this),function(e){return function(t,r){return void 0!==e?+e(t,r)||0:r!=r?-1:t!=t?1:0===t&&0===r?1/t>0&&1/r<0?1:-1:t>r}}(e))},!v||g)},2106:function(e,t,r){var n=r(283),o=r(4913);e.exports=function(e,t,r){return r.get&&n(r.get,t,{getter:!0}),r.set&&n(r.set,t,{setter:!0}),o.f(e,t,r)}},2140:function(e,t,r){var n={};n[r(8227)("toStringTag")]="z",e.exports="[object z]"===String(n)},2211:function(e,t,r){var n=r(9039);e.exports=!n(function(){function e(){}return e.prototype.constructor=null,Object.getPrototypeOf(new e)!==e.prototype})},2787:function(e,t,r){var n=r(9297),o=r(4901),a=r(8981),i=r(6119),u=r(2211),c=i("IE_PROTO"),s=Object,l=s.prototype;e.exports=u?s.getPrototypeOf:function(e){var t=a(e);if(n(t,c))return t[c];var r=t.constructor;return o(r)&&t instanceof r?r.prototype:t instanceof s?l:null}},2967:function(e,t,r){var n=r(6706),o=r(34),a=r(7750),i=r(3506);e.exports=Object.setPrototypeOf||("__proto__"in{}?function(){var e,t=!1,r={};try{(e=n(Object.prototype,"__proto__","set"))(r,[]),t=r instanceof Array}catch(u){}return function(r,n){return a(r),i(n),o(r)?(t?e(r,n):r.__proto__=n,r):r}}():void 0)},3109:function(e,t,r){r.r(t),r.d(t,{default:function(){return p}});var n=r(6540),o=(r(8845),r(373),r(5458)),a=r(6898);const i="BBBhf0wej5fkbxA9XcDE3fvbJRWCdTL61plMN8KdtMkWeKMzVF7b-5YBfLH__vJpq5CqrFqy3ittbRr4PtNCWcM";function u(e){const t=(e+"=".repeat((4-e.length%4)%4)).replace(/-/g,"+").replace(/_/g,"/"),r=atob(t);return Uint8Array.from((0,o.A)(r).map(e=>e.charCodeAt(0)))}function c(){return"undefined"!=typeof navigator&&/iphone|ipad|ipod/i.test(navigator.userAgent)}function s(){return"undefined"!=typeof window&&"undefined"!=typeof navigator&&(window.matchMedia("(display-mode: standalone)").matches||!0===navigator.standalone)}function l(e){let{onClose:t}=e;return n.createElement("div",{style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.65)",color:"white",padding:"2rem",zIndex:9999}},n.createElement("div",{style:{maxWidth:400,margin:"0 auto",background:"#222",padding:20,borderRadius:12}},n.createElement("h2",null,"Install this App"),n.createElement("p",null,"To enable notifications on your iPhone:"),n.createElement("ol",null,n.createElement("li",null,"Tap the ",n.createElement("strong",null,"Share")," button"," ",n.createElement("span",{style:{fontSize:"1.3rem"}},"⬆️")),n.createElement("li",null,"Choose ",n.createElement("strong",null,"Add to Home Screen")),n.createElement("li",null,"Re-open the app from your home screen")),n.createElement("button",{onClick:t,style:{marginTop:20,padding:"8px 14px",background:"#555",color:"white",borderRadius:6}},"Got it")))}function p(){const{subscribe:e,status:t}=function(){const{0:e,1:t}=(0,n.useState)("");return{subscribe:async function(e){try{if(t("Checking permission…"),"granted"!==await Notification.requestPermission())throw new Error("Permission denied by browser");const r=await navigator.serviceWorker.ready,n=await r.pushManager.getSubscription();if(n)return t("Already subscribed — updating db…"),await a.ND.from("push_subscriptions").insert({subscription:n.toJSON(),name:e.name||null,email:e.email||null,device:e.device||"primary phone"}),n;t("Subscribing…");const o=await r.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:u(i)}),{error:c}=await a.ND.from("push_subscriptions").insert({subscription:o.toJSON(),name:e.name||null,email:e.email||null,device:e.device||"primary phone"});if(c)throw new Error(c.message);return t("Subscribed!"),o}catch(r){throw t("Failed: "+r.message),r}},status:e}}(),{0:r,1:o}=(0,n.useState)(""),{0:p,1:f}=(0,n.useState)(""),{0:d,1:y}=(0,n.useState)("primary phone"),{0:h,1:m}=(0,n.useState)("Test Message"),{0:g,1:v}=(0,n.useState)("Hello from THV!"),{0:b,1:w}=(0,n.useState)(""),{0:A,1:E}=(0,n.useState)(!1);return(0,n.useEffect)(()=>{"undefined"!=typeof navigator&&"serviceWorker"in navigator&&navigator.serviceWorker.register("/pwa/service-worker.js",{scope:"/pwa/"})},[]),(0,n.useEffect)(()=>{c()&&!s()&&E(!0)},[]),n.createElement("div",{style:{padding:"2rem",maxWidth:600,margin:"0 auto"}},n.createElement("h1",null,"Web Push Notifications"),"undefined"!=typeof navigator&&/android/i.test(navigator.userAgent)&&n.createElement("p",{style:{color:"#0a0"}},"Android detected. Push works directly in browser. No install required."),c()&&s()&&n.createElement("p",{style:{color:"#0a0"}},"iOS PWA mode detected. Push subscription is supported."),c()&&!s()&&n.createElement("p",{style:{color:"orange"}},"iPhone detected. Install the app first to enable notifications."),n.createElement("h2",null,"Subscribe"),n.createElement("label",null,"Name"),n.createElement("input",{value:r,onChange:e=>o(e.target.value),placeholder:"Your name",style:{width:"100%",marginBottom:"1rem"}}),n.createElement("label",null,"Email"),n.createElement("input",{value:p,onChange:e=>f(e.target.value),placeholder:"you@example.com",style:{width:"100%",marginBottom:"1rem"}}),n.createElement("label",null,"Device"),n.createElement("input",{value:d,onChange:e=>y(e.target.value),placeholder:"primary phone",style:{width:"100%",marginBottom:"1rem"}}),n.createElement("button",{onClick:async function(){await e({name:r,email:p,device:d})}},"Subscribe Now"),t&&n.createElement("p",null,t),n.createElement("hr",{style:{margin:"2rem 0"}}),n.createElement("h2",null,"Send Push"),n.createElement("label",null,"Title"),n.createElement("input",{value:h,onChange:e=>m(e.target.value),style:{width:"100%",marginBottom:"1rem"}}),n.createElement("label",null,"Message"),n.createElement("textarea",{value:g,onChange:e=>v(e.target.value),rows:3,style:{width:"100%",marginBottom:"1rem"}}),n.createElement("button",{onClick:async function(){w("Sending…");try{const e=await async function(e,t){const{data:r,error:n}=await a.ND.from("push_subscriptions").select("subscription").order("created_at",{ascending:!1}).limit(1).maybeSingle();if(n)throw new Error(n.message);if(!r)throw new Error("No subscriptions found.");const o=r.subscription,i=await fetch("https://auth.tinhhoaviet.org.vn/push",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({secret:"Zf8uP1q9R4x!bA72Lk@cM39vD$wQeT6",subscription:o,title:e,body:t})}),u=await i.text();if(!i.ok)throw new Error(u);return"Push sent!"}(h,g);w(e)}catch(e){w(e.message)}}},"Send Push"),b&&n.createElement("p",null,b),A&&n.createElement(l,{onClose:()=>E(!1)}))}},3506:function(e,t,r){var n=r(3925),o=String,a=TypeError;e.exports=function(e){if(n(e))return e;throw new a("Can't set "+o(e)+" as a prototype")}},3607:function(e,t,r){var n=r(2839).match(/AppleWebKit\/(\d+)\./);e.exports=!!n&&+n[1]},3709:function(e,t,r){var n=r(2839).match(/firefox\/(\d+)/i);e.exports=!!n&&+n[1]},3763:function(e,t,r){var n=r(2839);e.exports=/MSIE|Trident/.test(n)},3925:function(e,t,r){var n=r(34);e.exports=function(e){return n(e)||null===e}},4488:function(e,t,r){var n=r(7680),o=Math.floor,a=function(e,t){var r=e.length;if(r<8)for(var i,u,c=1;c<r;){for(u=c,i=e[c];u&&t(e[u-1],i)>0;)e[u]=e[--u];u!==c++&&(e[u]=i)}else for(var s=o(r/2),l=a(n(e,0,s),t),p=a(n(e,s),t),f=l.length,d=p.length,y=0,h=0;y<f||h<d;)e[y+h]=y<f&&h<d?t(l[y],p[h])<=0?l[y++]:p[h++]:y<f?l[y++]:p[h++];return e};e.exports=a},4644:function(e,t,r){var n,o,a,i=r(7811),u=r(3724),c=r(4576),s=r(4901),l=r(34),p=r(9297),f=r(6955),d=r(6823),y=r(6699),h=r(6840),m=r(2106),g=r(1625),v=r(2787),b=r(2967),w=r(8227),A=r(3392),E=r(1181),T=E.enforce,x=E.get,S=c.Int8Array,_=S&&S.prototype,C=c.Uint8ClampedArray,P=C&&C.prototype,O=S&&v(S),k=_&&v(_),R=Object.prototype,N=c.TypeError,I=w("toStringTag"),M=A("TYPED_ARRAY_TAG"),W="TypedArrayConstructor",B=i&&!!b&&"Opera"!==f(c.opera),j=!1,U={Int8Array:1,Uint8Array:1,Uint8ClampedArray:1,Int16Array:2,Uint16Array:2,Int32Array:4,Uint32Array:4,Float32Array:4,Float64Array:8},D={BigInt64Array:8,BigUint64Array:8},F=function(e){var t=v(e);if(l(t)){var r=x(t);return r&&p(r,W)?r[W]:F(t)}},V=function(e){if(!l(e))return!1;var t=f(e);return p(U,t)||p(D,t)};for(n in U)(a=(o=c[n])&&o.prototype)?T(a)[W]=o:B=!1;for(n in D)(a=(o=c[n])&&o.prototype)&&(T(a)[W]=o);if((!B||!s(O)||O===Function.prototype)&&(O=function(){throw new N("Incorrect invocation")},B))for(n in U)c[n]&&b(c[n],O);if((!B||!k||k===R)&&(k=O.prototype,B))for(n in U)c[n]&&b(c[n].prototype,k);if(B&&v(P)!==k&&b(P,k),u&&!p(k,I))for(n in j=!0,m(k,I,{configurable:!0,get:function(){return l(this)?this[M]:void 0}}),U)c[n]&&y(c[n],M,n);e.exports={NATIVE_ARRAY_BUFFER_VIEWS:B,TYPED_ARRAY_TAG:j&&M,aTypedArray:function(e){if(V(e))return e;throw new N("Target is not a typed array")},aTypedArrayConstructor:function(e){if(s(e)&&(!b||g(O,e)))return e;throw new N(d(e)+" is not a typed array constructor")},exportTypedArrayMethod:function(e,t,r,n){if(u){if(r)for(var o in U){var a=c[o];if(a&&p(a.prototype,e))try{delete a.prototype[e]}catch(i){try{a.prototype[e]=t}catch(s){}}}k[e]&&!r||h(k,e,r?t:B&&_[e]||t,n)}},exportTypedArrayStaticMethod:function(e,t,r){var n,o;if(u){if(b){if(r)for(n in U)if((o=c[n])&&p(o,e))try{delete o[e]}catch(a){}if(O[e]&&!r)return;try{return h(O,e,r?t:B&&O[e]||t)}catch(a){}}for(n in U)!(o=c[n])||o[e]&&!r||h(o,e,t)}},getTypedArrayConstructor:F,isView:function(e){if(!l(e))return!1;var t=f(e);return"DataView"===t||p(U,t)||p(D,t)},isTypedArray:V,TypedArray:O,TypedArrayPrototype:k}},6706:function(e,t,r){var n=r(9504),o=r(9306);e.exports=function(e,t,r){try{return n(o(Object.getOwnPropertyDescriptor(e,t)[r]))}catch(a){}}},6955:function(e,t,r){var n=r(2140),o=r(4901),a=r(2195),i=r(8227)("toStringTag"),u=Object,c="Arguments"===a(function(){return arguments}());e.exports=n?a:function(e){var t,r,n;return void 0===e?"Undefined":null===e?"Null":"string"==typeof(r=function(e,t){try{return e[t]}catch(r){}}(t=u(e),i))?r:c?a(t):"Object"===(n=a(t))&&o(t.callee)?"Arguments":n}},7476:function(e,t,r){var n=r(2195),o=r(9504);e.exports=function(e){if("Function"===n(e))return o(e)}},7680:function(e,t,r){var n=r(9504);e.exports=n([].slice)},7811:function(e){e.exports="undefined"!=typeof ArrayBuffer&&"undefined"!=typeof DataView},8229:function(e,t,r){var n=r(9590),o=RangeError;e.exports=function(e,t){var r=n(e);if(r%t)throw new o("Wrong offset");return r}},8845:function(e,t,r){var n=r(4576),o=r(9565),a=r(4644),i=r(6198),u=r(8229),c=r(8981),s=r(9039),l=n.RangeError,p=n.Int8Array,f=p&&p.prototype,d=f&&f.set,y=a.aTypedArray,h=a.exportTypedArrayMethod,m=!s(function(){var e=new Uint8ClampedArray(2);return o(d,e,{length:1,0:3},1),3!==e[1]}),g=m&&a.NATIVE_ARRAY_BUFFER_VIEWS&&s(function(){var e=new p(2);return e.set(1),e.set("2",1),0!==e[0]||2!==e[1]});h("set",function(e){y(this);var t=u(arguments.length>1?arguments[1]:void 0,1),r=c(e);if(m)return o(d,this,r,t);var n=this.length,a=i(r),s=0;if(a+t>n)throw new l("Wrong length");for(;s<a;)this[t+s]=r[s++]},!m||g)},9590:function(e,t,r){var n=r(1291),o=RangeError;e.exports=function(e){var t=n(e);if(t<0)throw new o("The argument can't be less than 0");return t}}}]);
//# sourceMappingURL=component---src-pages-pwa-tsx-a9b76dcfcbf8c80caab0.js.map