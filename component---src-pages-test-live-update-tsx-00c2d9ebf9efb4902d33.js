"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[4300],{1974:function(e,t,n){n.r(t),n.d(t,{default:function(){return o}});var a=n(4506),r=n(6540),l=n(6898);function o(){const{0:e,1:t}=(0,r.useState)(null),{0:n,1:o}=(0,r.useState)([]),s=(0,r.useRef)(null),i=e=>{o(t=>[].concat((0,a.A)(t),["["+(new Date).toLocaleTimeString()+"] "+e]))};(0,r.useEffect)(()=>{s.current&&(s.current.scrollTop=s.current.scrollHeight)},[n]),(0,r.useEffect)(()=>{i("👂 Setting up realtime listener..."),l.ND.auth.getUser().then(e=>{var n;let{data:a}=e;const r=null!==(n=null==a?void 0:a.user)&&void 0!==n?n:null;t(r),i(r?"✅ Logged in as "+r.email+" ("+r.id+")":"❌ No user logged in")});const e=l.ND.channel("public:messages").on("postgres_changes",{event:"INSERT",schema:"public",table:"messages"},e=>{try{i("💬 New message event: "+e.new.event_type),i("📦 Payload: "+JSON.stringify(e.new.payload,null,2))}catch(t){i("⚠️ Received event, but failed to format payload.")}}).subscribe(e=>i("📡 Channel status: "+e));return()=>{i("🧹 Unsubscribing..."),l.ND.removeChannel(e)}},[]);return r.createElement("div",{style:{fontFamily:"monospace",padding:20,maxWidth:900,margin:"0 auto",color:"white"}},r.createElement("h2",null,"⚡ Realtime Test Console"),e?r.createElement("p",null,"✅ Logged in as:"," ",r.createElement("span",{style:{color:"#0f0"}},e.email||"unknown"," (",e.id,")")):r.createElement("p",null,"❌ Not logged in"),r.createElement("div",{style:{display:"flex",gap:"10px",marginBottom:"10px"}},r.createElement("button",{onClick:async()=>{if(!e)return void i("❌ Cannot send: no logged-in user.");i("🚀 Inserting new test message via Supabase...");const{error:t}=await l.ND.from("messages").insert([{user_id:e.id,event_type:"test_realtime_message",payload:{from:e.email,random_value:Math.floor(1e4*Math.random()),note:"Hello from RealtimeTest UI!"}}]);i(t?"❌ Insert failed: "+t.message:"✅ Insert request sent. Waiting for realtime callback...")},style:{padding:"8px 14px",background:"#0f0",color:"#000",border:"none",borderRadius:6,cursor:"pointer",fontWeight:"bold"}},"📨 Send Test Message")),r.createElement("pre",{ref:s,style:{background:"#000",color:"#0f0",padding:15,borderRadius:8,marginTop:20,height:500,fontSize:12,overflowY:"auto",whiteSpace:"pre-wrap"}},n.join("\n")))}}}]);
//# sourceMappingURL=component---src-pages-test-live-update-tsx-00c2d9ebf9efb4902d33.js.map