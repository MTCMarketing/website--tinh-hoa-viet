{"version":3,"file":"component---src-pages-cms-[user-id]-index-tsx-4237caea823a0ee9c336.js","mappings":"2HAKA,MAAMA,EAAO,CACXC,GAAI,CACFC,WAAY,gBACZC,QAAS,uDACTC,QAAS,6BACTC,SAAU,kBAEZC,GAAI,CACFJ,WAAY,gBACZC,QAAS,kDACTC,QAAS,4BACTC,SAAU,yBAmFd,IAzEsDE,IAI/C,IAJgD,SACrDC,EAAQ,WACRC,EAAa,WAAU,SACvBC,EAAW,MACZ,EACC,MAAM,EAACC,EAAQ,EAACC,IAAcC,EAAAA,EAAAA,UAAc,OACtC,EAACC,EAAO,EAACC,IAAaF,EAAAA,EAAAA,UAASb,EAAKU,GAAUN,UAC9C,EAACA,EAAQ,EAACY,IAAcH,EAAAA,EAAAA,WAAS,GAEjCI,EAAIjB,EAAKU,GAuCf,OArCAQ,EAAAA,EAAAA,WAAU,KACaC,WACnB,MAAM,KAAEC,EAAI,MAAEC,SAAgBC,EAAAA,GAASC,KAAKC,aAE5C,GAAIH,EAIF,OAHAI,QAAQJ,MAAM,iBAAkBA,GAChCN,EAAU,mCACVC,GAAW,GAIRI,EAAKT,SAIRC,EAAWQ,EAAKT,SAChBI,EAAU,uBAJVA,EAAU,8CACVW,WAAW,KAAMC,EAAAA,EAAAA,UAASlB,GAAa,OAMzCO,GAAW,IAGbY,GAEA,MAAQR,KAAMS,GAAaP,EAAAA,GAASC,KAAKO,kBAAkB,CAACC,EAAQpB,KAClEC,EAAWD,GACNA,IACHI,EAAUE,EAAEZ,UACZqB,WAAW,KAAMC,EAAAA,EAAAA,UAASlB,GAAa,SAI3C,MAAO,KACLoB,EAASG,aAAaC,gBAEvB,CAACxB,EAAYQ,EAAEZ,WAEdD,IAAYO,EAEZuB,EAAAA,cAAAA,MAAAA,CAAKC,UAAU,cACbD,EAAAA,cAAAA,QAAAA,CAAOC,UAAU,aAAa,kBAC5BD,EAAAA,cAAAA,MAAAA,CAAKC,UAAU,gBACfD,EAAAA,cAAAA,MAAAA,CAAKC,UAAU,kBACfD,EAAAA,cAAAA,MAAAA,CAAKC,UAAU,cACbD,EAAAA,cAAAA,KAAAA,CAAIC,UAAU,cAAclB,EAAEf,YAC9BgC,EAAAA,cAAAA,IAAAA,CAAGC,UAAU,aAAalB,EAAEd,WAIhC+B,EAAAA,cAAAA,OAAAA,CAAMC,UAAU,aACdD,EAAAA,cAAAA,MAAAA,CAAKC,UAAU,iBACbD,EAAAA,cAAAA,MAAAA,CAAKC,UAAU,YACfD,EAAAA,cAAAA,IAAAA,CAAGC,UAAU,gBAAgBrB,MAOhCoB,EAAAA,cAAAA,EAAAA,SAAAA,KAAG1B,G,yECvEZ,UAnB8B4B,KAC5B,MAAMC,GAAWC,EAAAA,EAAAA,eAGXC,GAASC,EAAAA,EAAAA,SAAQ,KACrB,MAAMC,IAASJ,aAAQ,EAARA,EAAUK,WAAY,IAAIC,QAAQ,OAAQ,IAAIC,MAAM,KACnE,OAAOH,EAAMA,EAAMI,OAAS,SAAMC,GACjC,CAACT,aAAQ,EAARA,EAAUK,WAEd,OAAQR,EAAAA,cAAAA,EAAAA,SAAAA,KACRA,EAAAA,cAACa,EAAAA,EAAc,KACbb,EAAAA,cAACc,EAAAA,EAAI,CAACC,GAAIV,M","sources":["webpack:///./src/componets/shared/ProtectedRoute/ProtectedRoute.tsx","webpack:///./src/pages/cms/[user-id]/index.tsx"],"sourcesContent":["import React, { useEffect, useState } from \"react\";\nimport { navigate } from \"gatsby\";\nimport { supabase } from \"../../../database/supabaseClient\";\nimport \"./protected.css\";\n\nconst i18n = {\n  EN: {\n    brandTitle: \"TINH HOA VIỆT\",\n    tagline: \"Where Vietnamese Excellence Meets Global Recognition\",\n    loading: \"Checking authentication...\",\n    redirect: \"Redirecting...\",\n  },\n  VN: {\n    brandTitle: \"TINH HOA VIỆT\",\n    tagline: \"Nơi tôn vinh tinh hoa Việt Nam vươn tầm quốc tế\",\n    loading: \"Đang kiểm tra xác thực...\",\n    redirect: \"Đang chuyển hướng...\",\n  },\n};\n\ninterface ProtectedRouteProps {\n  children: React.ReactNode;\n  redirectTo?: string;\n  language?: \"EN\" | \"VN\";\n}\n\nconst ProtectedRoute: React.FC<ProtectedRouteProps> = ({\n  children,\n  redirectTo = \"/sign-in\",\n  language = \"EN\",\n}) => {\n  const [session, setSession] = useState<any>(null);\n  const [status, setStatus] = useState(i18n[language].loading);\n  const [loading, setLoading] = useState(true);\n\n  const t = i18n[language];\n\n  useEffect(() => {\n    const checkSession = async () => {\n      const { data, error } = await supabase.auth.getSession();\n\n      if (error) {\n        console.error(\"Session error:\", error);\n        setStatus(\"⚠️ Error checking session.\");\n        setLoading(false);\n        return;\n      }\n\n      if (!data.session) {\n        setStatus(\"❌ You must be logged in to view this page.\");\n        setTimeout(() => navigate(redirectTo), 1800);\n      } else {\n        setSession(data.session);\n        setStatus(\"✅ Access granted!\");\n      }\n\n      setLoading(false);\n    };\n\n    checkSession();\n\n    const { data: listener } = supabase.auth.onAuthStateChange((_event, session) => {\n      setSession(session);\n      if (!session) {\n        setStatus(t.redirect);\n        setTimeout(() => navigate(redirectTo), 1500);\n      }\n    });\n\n    return () => {\n      listener.subscription.unsubscribe();\n    };\n  }, [redirectTo, t.redirect]);\n\n  if (loading || !session) {\n    return (\n      <div className=\"auth-shell\">\n        <aside className=\"brand-side\" aria-hidden>\n          <div className=\"brand-sheen\" />\n          <div className=\"brand-pattern\" />\n          <div className=\"brand-wrap\">\n            <h1 className=\"brand-name\">{t.brandTitle}</h1>\n            <p className=\"brand-tag\">{t.tagline}</p>\n          </div>\n        </aside>\n\n        <main className=\"form-side\">\n          <div className=\"loading-block\">\n            <div className=\"spinner\" />\n            <p className=\"loading-text\">{status}</p>\n          </div>\n        </main>\n      </div>\n    );\n  }\n\n  return <>{children}</>;\n};\n\nexport default ProtectedRoute;\n","import React, { useMemo } from \"react\";\nimport { useLocation } from \"@reach/router\";\nimport ProtectedRoute from \"../../../componets/shared/ProtectedRoute/ProtectedRoute\";\nimport User from \"../../../componets/cms/User\";\n\n\nconst MessagePage: React.FC = () => {\n  const location = useLocation();\n\n  // Extract optional messageId from URL\n  const userId = useMemo(() => {\n    const parts = (location?.pathname || \"\").replace(/\\/+$/, \"\").split(\"/\");\n    return parts[parts.length - 1] || undefined;\n  }, [location?.pathname]);\n\n  return (<>\n  <ProtectedRoute>\n    <User id={userId}/>\n  </ProtectedRoute>\n  \n  \n  \n  </>)\n};\n\nexport default MessagePage;\n"],"names":["i18n","EN","brandTitle","tagline","loading","redirect","VN","_ref","children","redirectTo","language","session","setSession","useState","status","setStatus","setLoading","t","useEffect","async","data","error","supabase","auth","getSession","console","setTimeout","navigate","checkSession","listener","onAuthStateChange","_event","subscription","unsubscribe","React","className","MessagePage","location","useLocation","userId","useMemo","parts","pathname","replace","split","length","undefined","ProtectedRoute","User","id"],"sourceRoot":""}