{"version":3,"file":"component---src-pages-cms-[user-id]-message-index-tsx-6c7c8cc27b1b4ed989e8.js","mappings":"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","sources":["webpack:///./src/componets/shared/ProtectedRoute/ProtectedRoute.tsx","webpack:///./node_modules/lucide-react/dist/esm/icons/settings.js","webpack:///./node_modules/lucide-react/dist/esm/icons/sun.js","webpack:///./node_modules/lucide-react/dist/esm/icons/log-out.js","webpack:///./node_modules/lucide-react/dist/esm/icons/send.js","webpack:///./node_modules/lucide-react/dist/esm/icons/paperclip.js","webpack:///./node_modules/lucide-react/dist/esm/icons/moon.js","webpack:///./node_modules/lucide-react/dist/esm/icons/x.js","webpack:///./node_modules/lucide-react/dist/esm/icons/menu.js","webpack:///./node_modules/lucide-react/dist/esm/shared/src/utils.js","webpack:///./node_modules/lucide-react/dist/esm/defaultAttributes.js","webpack:///./node_modules/lucide-react/dist/esm/Icon.js","webpack:///./node_modules/lucide-react/dist/esm/createLucideIcon.js","webpack:///./src/componets/cms/ChatStyle.ts","webpack:///./src/componets/cms/Chat.tsx","webpack:///./src/componets/cms/ChatFunctions.ts","webpack:///./src/pages/cms/[user-id]/message/index.tsx","webpack:///./src/safe/location.ts"],"sourcesContent":["import React, { useEffect, useState } from \"react\";\nimport { navigate } from \"gatsby\";\nimport { supabase } from \"../../../database/supabaseClient\";\nimport \"./protected.css\";\n\nconst i18n = {\n  EN: {\n    brandTitle: \"TINH HOA VI·ªÜT\",\n    tagline: \"Where Vietnamese Excellence Meets Global Recognition\",\n    loading: \"Checking authentication...\",\n    redirect: \"Redirecting...\",\n  },\n  VN: {\n    brandTitle: \"TINH HOA VI·ªÜT\",\n    tagline: \"N∆°i t√¥n vinh tinh hoa Vi·ªát Nam v∆∞∆°n t·∫ßm qu·ªëc t·∫ø\",\n    loading: \"ƒêang ki·ªÉm tra x√°c th·ª±c...\",\n    redirect: \"ƒêang chuy·ªÉn h∆∞·ªõng...\",\n  },\n};\n\ninterface ProtectedRouteProps {\n  children: React.ReactNode;\n  redirectTo?: string;\n  language?: \"EN\" | \"VN\";\n}\n\nconst ProtectedRoute: React.FC<ProtectedRouteProps> = ({\n  children,\n  redirectTo = \"/sign-in\",\n  language = \"EN\",\n}) => {\n  const [session, setSession] = useState<any>(null);\n  const [status, setStatus] = useState(i18n[language].loading);\n  const [loading, setLoading] = useState(true);\n\n  const t = i18n[language];\n\n  useEffect(() => {\n    const checkSession = async () => {\n      const { data, error } = await supabase.auth.getSession();\n\n      if (error) {\n        console.error(\"Session error:\", error);\n        setStatus(\"‚ö†Ô∏è Error checking session.\");\n        setLoading(false);\n        return;\n      }\n\n      if (!data.session) {\n        setStatus(\"‚ùå You must be logged in to view this page.\");\n        setTimeout(() => navigate(redirectTo), 1800);\n      } else {\n        setSession(data.session);\n        setStatus(\"‚úÖ Access granted!\");\n      }\n\n      setLoading(false);\n    };\n\n    checkSession();\n\n    const { data: listener } = supabase.auth.onAuthStateChange((_event, session) => {\n      setSession(session);\n      if (!session) {\n        setStatus(t.redirect);\n        setTimeout(() => navigate(redirectTo), 1500);\n      }\n    });\n\n    return () => {\n      listener.subscription.unsubscribe();\n    };\n  }, [redirectTo, t.redirect]);\n\n  if (loading || !session) {\n    return (\n      <div className=\"auth-shell\">\n        <aside className=\"brand-side\" aria-hidden>\n          <div className=\"brand-sheen\" />\n          <div className=\"brand-pattern\" />\n          <div className=\"brand-wrap\">\n            <h1 className=\"brand-name\">{t.brandTitle}</h1>\n            <p className=\"brand-tag\">{t.tagline}</p>\n          </div>\n        </aside>\n\n        <main className=\"form-side\">\n          <div className=\"loading-block\">\n            <div className=\"spinner\" />\n            <p className=\"loading-text\">{status}</p>\n          </div>\n        </main>\n      </div>\n    );\n  }\n\n  return <>{children}</>;\n};\n\nexport default ProtectedRoute;\n","/**\n * @license lucide-react v0.548.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [\n  [\n    \"path\",\n    {\n      d: \"M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915\",\n      key: \"1i5ecw\"\n    }\n  ],\n  [\"circle\", { cx: \"12\", cy: \"12\", r: \"3\", key: \"1v7zrd\" }]\n];\nconst Settings = createLucideIcon(\"settings\", __iconNode);\n\nexport { __iconNode, Settings as default };\n//# sourceMappingURL=settings.js.map\n","/**\n * @license lucide-react v0.548.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [\n  [\"circle\", { cx: \"12\", cy: \"12\", r: \"4\", key: \"4exip2\" }],\n  [\"path\", { d: \"M12 2v2\", key: \"tus03m\" }],\n  [\"path\", { d: \"M12 20v2\", key: \"1lh1kg\" }],\n  [\"path\", { d: \"m4.93 4.93 1.41 1.41\", key: \"149t6j\" }],\n  [\"path\", { d: \"m17.66 17.66 1.41 1.41\", key: \"ptbguv\" }],\n  [\"path\", { d: \"M2 12h2\", key: \"1t8f8n\" }],\n  [\"path\", { d: \"M20 12h2\", key: \"1q8mjw\" }],\n  [\"path\", { d: \"m6.34 17.66-1.41 1.41\", key: \"1m8zz5\" }],\n  [\"path\", { d: \"m19.07 4.93-1.41 1.41\", key: \"1shlcs\" }]\n];\nconst Sun = createLucideIcon(\"sun\", __iconNode);\n\nexport { __iconNode, Sun as default };\n//# sourceMappingURL=sun.js.map\n","/**\n * @license lucide-react v0.548.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [\n  [\"path\", { d: \"m16 17 5-5-5-5\", key: \"1bji2h\" }],\n  [\"path\", { d: \"M21 12H9\", key: \"dn1m92\" }],\n  [\"path\", { d: \"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4\", key: \"1uf3rs\" }]\n];\nconst LogOut = createLucideIcon(\"log-out\", __iconNode);\n\nexport { __iconNode, LogOut as default };\n//# sourceMappingURL=log-out.js.map\n","/**\n * @license lucide-react v0.548.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [\n  [\n    \"path\",\n    {\n      d: \"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z\",\n      key: \"1ffxy3\"\n    }\n  ],\n  [\"path\", { d: \"m21.854 2.147-10.94 10.939\", key: \"12cjpa\" }]\n];\nconst Send = createLucideIcon(\"send\", __iconNode);\n\nexport { __iconNode, Send as default };\n//# sourceMappingURL=send.js.map\n","/**\n * @license lucide-react v0.548.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [\n  [\n    \"path\",\n    {\n      d: \"m16 6-8.414 8.586a2 2 0 0 0 2.829 2.829l8.414-8.586a4 4 0 1 0-5.657-5.657l-8.379 8.551a6 6 0 1 0 8.485 8.485l8.379-8.551\",\n      key: \"1miecu\"\n    }\n  ]\n];\nconst Paperclip = createLucideIcon(\"paperclip\", __iconNode);\n\nexport { __iconNode, Paperclip as default };\n//# sourceMappingURL=paperclip.js.map\n","/**\n * @license lucide-react v0.548.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [\n  [\n    \"path\",\n    {\n      d: \"M20.985 12.486a9 9 0 1 1-9.473-9.472c.405-.022.617.46.402.803a6 6 0 0 0 8.268 8.268c.344-.215.825-.004.803.401\",\n      key: \"kfwtm\"\n    }\n  ]\n];\nconst Moon = createLucideIcon(\"moon\", __iconNode);\n\nexport { __iconNode, Moon as default };\n//# sourceMappingURL=moon.js.map\n","/**\n * @license lucide-react v0.548.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [\n  [\"path\", { d: \"M18 6 6 18\", key: \"1bl5f8\" }],\n  [\"path\", { d: \"m6 6 12 12\", key: \"d8bk6v\" }]\n];\nconst X = createLucideIcon(\"x\", __iconNode);\n\nexport { __iconNode, X as default };\n//# sourceMappingURL=x.js.map\n","/**\n * @license lucide-react v0.548.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [\n  [\"path\", { d: \"M4 5h16\", key: \"1tepv9\" }],\n  [\"path\", { d: \"M4 12h16\", key: \"1lakjw\" }],\n  [\"path\", { d: \"M4 19h16\", key: \"1djgab\" }]\n];\nconst Menu = createLucideIcon(\"menu\", __iconNode);\n\nexport { __iconNode, Menu as default };\n//# sourceMappingURL=menu.js.map\n","/**\n * @license lucide-react v0.548.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nconst toKebabCase = (string) => string.replace(/([a-z0-9])([A-Z])/g, \"$1-$2\").toLowerCase();\nconst toCamelCase = (string) => string.replace(\n  /^([A-Z])|[\\s-_]+(\\w)/g,\n  (match, p1, p2) => p2 ? p2.toUpperCase() : p1.toLowerCase()\n);\nconst toPascalCase = (string) => {\n  const camelCase = toCamelCase(string);\n  return camelCase.charAt(0).toUpperCase() + camelCase.slice(1);\n};\nconst mergeClasses = (...classes) => classes.filter((className, index, array) => {\n  return Boolean(className) && className.trim() !== \"\" && array.indexOf(className) === index;\n}).join(\" \").trim();\nconst hasA11yProp = (props) => {\n  for (const prop in props) {\n    if (prop.startsWith(\"aria-\") || prop === \"role\" || prop === \"title\") {\n      return true;\n    }\n  }\n};\n\nexport { hasA11yProp, mergeClasses, toCamelCase, toKebabCase, toPascalCase };\n//# sourceMappingURL=utils.js.map\n","/**\n * @license lucide-react v0.548.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nvar defaultAttributes = {\n  xmlns: \"http://www.w3.org/2000/svg\",\n  width: 24,\n  height: 24,\n  viewBox: \"0 0 24 24\",\n  fill: \"none\",\n  stroke: \"currentColor\",\n  strokeWidth: 2,\n  strokeLinecap: \"round\",\n  strokeLinejoin: \"round\"\n};\n\nexport { defaultAttributes as default };\n//# sourceMappingURL=defaultAttributes.js.map\n","/**\n * @license lucide-react v0.548.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport { forwardRef, createElement } from 'react';\nimport defaultAttributes from './defaultAttributes.js';\nimport { mergeClasses, hasA11yProp } from './shared/src/utils.js';\n\nconst Icon = forwardRef(\n  ({\n    color = \"currentColor\",\n    size = 24,\n    strokeWidth = 2,\n    absoluteStrokeWidth,\n    className = \"\",\n    children,\n    iconNode,\n    ...rest\n  }, ref) => createElement(\n    \"svg\",\n    {\n      ref,\n      ...defaultAttributes,\n      width: size,\n      height: size,\n      stroke: color,\n      strokeWidth: absoluteStrokeWidth ? Number(strokeWidth) * 24 / Number(size) : strokeWidth,\n      className: mergeClasses(\"lucide\", className),\n      ...!children && !hasA11yProp(rest) && { \"aria-hidden\": \"true\" },\n      ...rest\n    },\n    [\n      ...iconNode.map(([tag, attrs]) => createElement(tag, attrs)),\n      ...Array.isArray(children) ? children : [children]\n    ]\n  )\n);\n\nexport { Icon as default };\n//# sourceMappingURL=Icon.js.map\n","/**\n * @license lucide-react v0.548.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport { forwardRef, createElement } from 'react';\nimport { mergeClasses, toKebabCase, toPascalCase } from './shared/src/utils.js';\nimport Icon from './Icon.js';\n\nconst createLucideIcon = (iconName, iconNode) => {\n  const Component = forwardRef(\n    ({ className, ...props }, ref) => createElement(Icon, {\n      ref,\n      iconNode,\n      className: mergeClasses(\n        `lucide-${toKebabCase(toPascalCase(iconName))}`,\n        `lucide-${iconName}`,\n        className\n      ),\n      ...props\n    })\n  );\n  Component.displayName = toPascalCase(iconName);\n  return Component;\n};\n\nexport { createLucideIcon as default };\n//# sourceMappingURL=createLucideIcon.js.map\n","export const chatStyle = `\n        body, html { margin: 0; font-family: 'Inter', sans-serif; }\n        .app { min-height: 100vh; background: var(--bg); color: var(--text);\n          transition: background .3s, color .3s; display: flex; flex-direction: column; }\n        .app.light { --bg: #f8fafc; --panel: #ffffff; --border: rgba(0,0,0,0.08);\n          --text: #111827; --muted: #6b7280; --accent: #10b981; --accent-bg: rgba(16,185,129,0.1);}\n        .app.dark { --bg: #0f1318; --panel: #0b0f14; --border: rgba(255,255,255,0.08);\n          --text: #d1d5db; --muted: #9ca3af; --accent: #10b981; --accent-bg: rgba(16,185,129,0.15);}\n        header { background: var(--panel); border-bottom: 1px solid var(--border);\n          padding: 12px 20px; display: flex; align-items: center; justify-content: space-between; position: sticky; top: 0; z-index: 30;}\n        .brand { display: flex; align-items: center; gap: 8px; font-weight: 600; color: var(--text); font-size: 14px;}\n        .brand-icon { width: 24px; height: 24px; background: linear-gradient(135deg, #10b981, #059669); border-radius: 3px;}\n        .actions { display: flex; align-items: center; gap: 10px;}\n        button { border: none; border-radius: 5px; font-size: 13px; padding: 7px 12px; cursor: pointer;\n          background: var(--panel); color: var(--text); display: flex; align-items: center; gap: 6px; transition: all .2s;}\n        button:hover { background: var(--accent-bg); }\n        .primary-btn { background: var(--accent); color: #072c21; font-weight: 500;}\n        .chat-area { flex: 1; overflow-y: auto; padding: 20px; padding-bottom: 100px; }\n       .chat-row {\n  width: 100%;\n  display: flex;\n  flex-direction: column;\n}\n\n/* every bubble sits on its own row */\n.chat-bubble {\n  display: block;            /* <‚Äî force new line */\n  width: fit-content;        /* shrink to message text */\n  max-width: 300px;          /* cap the width */\n  border-radius: 12px;\n  padding: 10px 14px;\n  word-break: break-word;\n  line-height: 1.4;\n  margin-bottom: 10px;\n}\n\n.outbound {\n  background: var(--accent);\n  color: #072c21;\n  margin-left: auto;         /* right aligned */\n  border-top-right-radius: 6px;\n}\n\n.inbound {\n  background: var(--panel);\n  border: 1px solid var(--border);\n  color: var(--text);\n  margin-right: auto;        /* left aligned */\n  border-top-left-radius: 6px;\n}\n\n        .timestamp { font-size: 11px; opacity: 0.6; margin-top: 4px; text-align: right; }\n        .sticky-footer { position: sticky; bottom: 0; background: var(--panel); border-top: 1px solid var(--border);\n          padding: 12px 20px; display: flex; align-items: center; gap: 10px; }\n        input.msg-input { flex-grow: 1; border-radius: 8px; border: 1px solid var(--border);\n          background: var(--panel); color: var(--text); padding: 10px; font-size: 14px; }\n        footer { text-align: center; color: var(--muted); font-size: 12px; margin: 20px 0; }\n        .dropdown { position: relative;}\n        .menu { position: absolute; top: 110%; right: 0; background: var(--panel); border: 1px solid var(--border);\n          border-radius: 8px; box-shadow: 0 4px 10px rgba(0,0,0,0.2); width: 160px; overflow: hidden; z-index: 50; display: none;}\n        .menu.open { display: block; }\n      `","\"use client\";\n\nimport React, { useState, useRef, useEffect } from \"react\";\nimport {\n  Settings,\n  LogOut,\n  Sun,\n  Moon,\n  Menu,\n  X,\n  Paperclip,\n  Send,\n} from \"lucide-react\";\nimport {\n  getCurrentUserId,\n  fetchMessagesForUser,\n  sendMessage,\n  subscribeToMessages,\n} from \"./ChatFunctions\";\nimport { supabase } from \"../../database/supabaseClient\";\nimport { chatStyle } from \"./ChatStyle\";\n\ninterface SendMessageProps {\n  userId?: string;\n}\n\nexport const AdminChat: React.FC<SendMessageProps> = ({ userId }: any) => {\n  const [theme, setTheme] = useState<\"light\" | \"dark\">(\"light\");\n  const [open, setOpen] = useState(false);\n  const [navOpen, setNavOpen] = useState(false);\n  const [message, setMessage] = useState(\"\");\n  const [attachments, setAttachments] = useState<File[]>([]);\n  const [sending, setSending] = useState(false);\n  const [messages, setMessages] = useState<any[]>([]);\n  const [currentUserId, setCurrentUserId] = useState<string | null>(null);\n\n  const menuRef = useRef<HTMLDivElement>(null);\n  const fileInputRef = useRef<HTMLInputElement>(null);\n  const chatEndRef = useRef<HTMLDivElement>(null);\n\n  /* ============================================================\n     üß† Load current admin & initial messages\n     ============================================================ */\n  useEffect(() => {\n    getCurrentUserId().then(setCurrentUserId);\n  }, []);\n\n  useEffect(() => {\n    if (!userId) return;\n\n    (async () => {\n      try {\n        console.log(\"üîç Pulling messages from:\", userId);\n        const data = await fetchMessagesForUser(userId);\n        console.log(`‚úÖ ${data.length} rows returned`, data);\n        setMessages(data);\n      } catch (err: any) {\n        console.error(\"‚ùå Fetch failed:\", err.message);\n      }\n    })();\n  }, [userId]);\n/* ============================================================\n   üëÇ Realtime listener (scoped via helper)\n   ============================================================ */\nuseEffect(() => {\n  if (!currentUserId) return;\n  if (!userId) return;\n\n  let channel: any;\n\n  (async () => {\n    channel = await subscribeToMessages(userId, (newMessage) => {\n      setMessages((prev) => {\n        const exists = prev.some((m) => m.id === newMessage.id);\n        return exists ? prev : [...prev, newMessage];\n      });\n    });\n  })();\n\n  return () => {\n    if (channel) {\n      console.log(\"üßπ Unsubscribing from dm_messages channel\");\n      supabase.removeChannel(channel);\n    }\n  };\n}, [currentUserId, userId]);\n\n  /* ============================================================\n     ‚è¨ Auto-scroll to bottom\n     ============================================================ */\n  useEffect(() => {\n    chatEndRef.current?.scrollIntoView({ behavior: \"smooth\" });\n  }, [messages]);\n\n  /* ============================================================\n     üìé Attachments\n     ============================================================ */\n  const handleAttach = (e: React.ChangeEvent<HTMLInputElement>) => {\n    if (e.target.files) {\n      const newFiles = Array.from(e.target.files);\n      setAttachments((prev) => [...prev, ...newFiles]);\n    }\n  };\n\n  const handleRemove = (index: number) => {\n    setAttachments((prev) => prev.filter((_, i) => i !== index));\n  };\n\n  /* ============================================================\n     üöÄ Send Message\n     ============================================================ */\n  const handleSend = async () => {\n    if (!message.trim() && attachments.length === 0) return;\n    if (!currentUserId) return;\n\n    setSending(true);\n    try {\n      const data = await sendMessage(currentUserId, message, userId ?? null);\n      if (data && data[0]) {\n        // Optimistic append\n        setMessages((prev) => [...prev, data[0]]);\n        setMessage(\"\"); // clear input\n        setAttachments([]);\n      }\n    } catch (err: any) {\n      alert(\"‚ùå Send failed: \" + err.message);\n    } finally {\n      setSending(false);\n    }\n  };\n\n  /* ============================================================\n     üß≠ Menu Toggle\n     ============================================================ */\n  useEffect(() => {\n    const handleClick = (e: MouseEvent) => {\n      if (menuRef.current && !menuRef.current.contains(e.target as Node))\n        setOpen(false);\n    };\n    document.addEventListener(\"click\", handleClick);\n    return () => document.removeEventListener(\"click\", handleClick);\n  }, []);\n\n  /* ============================================================\n     üñºÔ∏è UI\n     ============================================================ */\n  return (\n    <div className={`app ${theme}`}>\n      <style>{chatStyle}</style>\n\n      <header>\n        <div className=\"brand\">\n          <button\n            onClick={() => setNavOpen(!navOpen)}\n            style={{ background: \"none\", border: \"none\", cursor: \"pointer\" }}\n          >\n            {navOpen ? <X size={18} /> : <Menu size={18} />}\n          </button>\n          <div className=\"brand-icon\" />\n          Admin Messages\n        </div>\n        <div className=\"actions\">\n          <div className=\"dropdown\" ref={menuRef}>\n            <button onClick={() => setOpen(!open)}>\n              <Settings size={14} /> Settings\n            </button>\n            <div className={`menu ${open ? \"open\" : \"\"}`}>\n              <button onClick={() => alert(\"Profile clicked\")}>Profile</button>\n              <button onClick={() => alert(\"Preferences clicked\")}>\n                Preferences\n              </button>\n              <hr />\n              <button\n                onClick={() => setTheme(theme === \"light\" ? \"dark\" : \"light\")}\n              >\n                {theme === \"light\" ? <Moon size={14} /> : <Sun size={14} />} Theme:{\" \"}\n                {theme === \"light\" ? \"Dark\" : \"Light\"}\n              </button>\n            </div>\n          </div>\n          <button className=\"primary-btn\">\n            <LogOut size={14} /> Sign out\n          </button>\n        </div>\n      </header>\n\n      {/* Chat area */}\n      <div className=\"chat-area\">\n        {messages.map((msg) => {\n          const isOutbound = msg.sender_id === currentUserId;\n          return (\n            <div\n              key={msg.id}\n              className={`chat-bubble ${isOutbound ? \"outbound\" : \"inbound\"}`}\n            >\n              <div>{msg.message}</div>\n              <div className=\"timestamp\">\n                {new Date(msg.created_at).toLocaleTimeString([], {\n                  hour: \"2-digit\",\n                  minute: \"2-digit\",\n                })}\n              </div>\n            </div>\n          );\n        })}\n        <div ref={chatEndRef} />\n      </div>\n\n      {/* Sticky Footer */}\n      <div className=\"sticky-footer\">\n        <button\n          onClick={() => fileInputRef.current?.click()}\n          style={{\n            background: \"none\",\n            border: \"none\",\n            color: \"var(--accent)\",\n            cursor: \"pointer\",\n          }}\n        >\n          <Paperclip size={18} />\n        </button>\n\n        <input\n          type=\"file\"\n          ref={fileInputRef}\n          multiple\n          onChange={handleAttach}\n          style={{ display: \"none\" }}\n        />\n\n        <input\n          value={message}\n          onChange={(e) => setMessage(e.target.value)}\n          placeholder=\"Type your message...\"\n          className=\"msg-input\"\n          onKeyDown={(e) => {\n            if (e.key === \"Enter\" && !e.shiftKey) {\n              e.preventDefault();\n              handleSend();\n            }\n          }}\n        />\n\n        <button\n          onClick={handleSend}\n          disabled={sending}\n          style={{\n            background: \"var(--accent)\",\n            color: \"#072c21\",\n            borderRadius: \"8px\",\n            padding: \"10px 14px\",\n            fontWeight: 500,\n            cursor: \"pointer\",\n            opacity: sending ? 0.8 : 1,\n            display: \"flex\",\n            alignItems: \"center\",\n            gap: \"6px\",\n          }}\n        >\n          <Send size={18} />\n        </button>\n      </div>\n    </div>\n  );\n};\n","import { supabase } from \"../../database/supabaseClient\";\n\n/* ============================================================\n   üß† AUTH HELPERS\n   ============================================================ */\nexport async function getCurrentUserId(): Promise<string | null> {\n  const { data, error } = await supabase.auth.getSession();\n  if (error) console.error(\"‚ö†Ô∏è getSession error:\", error.message);\n  const uid = data.session?.user?.id ?? null;\n  console.log(\"üë§ Current User ID:\", uid);\n  return uid;\n}\n\n/* ============================================================\n   üì¶ FETCH MESSAGES\n   ============================================================ */\nexport async function fetchMessagesForUser(targetUserId: string) {\n  const { data: session } = await supabase.auth.getSession();\n  const uid = session?.session?.user?.id ?? null;\n  console.log(\"üì¶ Fetching messages | acting as:\", uid, \"| target:\", targetUserId);\n\n  // ‚úÖ Include both sender and recipient sides\n  const { data, error } = await supabase\n    .from(\"dm_messages\")\n    .select(\"*\")\n    .or(`sender_id.eq.${targetUserId},recipient_id.eq.${targetUserId}`)\n    .order(\"created_at\", { ascending: true });\n\n  if (error) throw error;\n  console.log(`‚úÖ Loaded ${data?.length ?? 0} messages`);\n  return data;\n}\n\n/* ============================================================\n   üëÇ REALTIME SUBSCRIBE\n   ============================================================ */\n\n   export async function subscribeToMessages(\n  targetUserId: string,\n  onMessage: (msg: any) => void\n) {\n  console.log(\"üëÇ Subscribing to realtime messages involving:\", targetUserId);\n\n  const channel = supabase\n    .channel(`dm_messages_${targetUserId}`)\n    // when this user sends\n    .on(\n      \"postgres_changes\",\n      {\n        event: \"INSERT\",\n        schema: \"public\",\n        table: \"dm_messages\",\n        filter: `sender_id=eq.${targetUserId}`,\n      },\n      (payload) => {\n        console.log(\"üì® Realtime (as sender):\", payload.new);\n        onMessage(payload.new);\n      }\n    )\n    // when this user receives\n    .on(\n      \"postgres_changes\",\n      {\n        event: \"INSERT\",\n        schema: \"public\",\n        table: \"dm_messages\",\n        filter: `recipient_id=eq.${targetUserId}`,\n      },\n      (payload) => {\n        console.log(\"üì© Realtime (as recipient):\", payload.new);\n        onMessage(payload.new);\n      }\n    )\n    .subscribe((status) => console.log(\"üì° Channel status:\", status));\n\n  return channel;\n}\n\n\n/* ============================================================\n   üöÄ SEND MESSAGE\n   ============================================================ */\nexport async function sendMessage(\n  senderId: string,\n  message: string,\n  recipientId: string | null\n) {\n  console.log(\"üöÄ Sending message...\", { senderId, recipientId, message });\n\n  const { data, error } = await supabase\n    .from(\"dm_messages\")\n    .insert([{ sender_id: senderId, message, recipient_id: recipientId }])\n    .select();\n\n  if (error) {\n    console.error(\"üî• Supabase insert error:\", error);\n    throw error;\n  }\n\n  console.log(\"‚úÖ Message sent:\", data);\n  return data;\n}\n","\nimport React, { useMemo } from \"react\";\nimport ProtectedRoute from \"../../../../componets/shared/ProtectedRoute/ProtectedRoute\";\nimport { AdminChat } from \"../../../../componets/cms/Chat\";\nimport { getLocationSafe } from \"../../../../safe/location\";\n\n\nexport default () => {\n  const location = getLocationSafe();\n\n  const id: string | null = useMemo(() => {\n    if (!location?.pathname) return null;\n    const parts = location.pathname.split(\"/\");\n    return parts[parts.length - 1] || null;\n  }, [location?.pathname]);\n\n  return (\n    <ProtectedRoute>\n      {id ? (\n        <AdminChat userId={id} />\n      ) : (\n        <div style={{ padding: 40, textAlign: \"center\" }}>\n          ‚ö†Ô∏è Invalid or missing user ID\n        </div>\n      )}\n    </ProtectedRoute>\n  );\n};","/**\n * ‚úÖ Safe wrapper for window.location ‚Äî never crashes during SSR.\n */\nexport function getLocationSafe(): Location | null {\n  if (typeof window === \"undefined\" || typeof window.location === \"undefined\") {\n    return null;\n  }\n  return window.location;\n}\n"],"names":["i18n","EN","brandTitle","tagline","loading","redirect","VN","_ref","children","redirectTo","language","session","setSession","useState","status","setStatus","setLoading","t","useEffect","async","data","error","supabase","auth","getSession","console","setTimeout","navigate","checkSession","listener","onAuthStateChange","_event","subscription","unsubscribe","React","className","Settings","d","key","cx","cy","r","Sun","LogOut","Send","Paperclip","Moon","X","Menu","toPascalCase","string","camelCase","replace","match","p1","p2","toUpperCase","toLowerCase","toCamelCase","charAt","slice","mergeClasses","classes","filter","index","array","Boolean","trim","indexOf","join","hasA11yProp","props","prop","startsWith","defaultAttributes","xmlns","width","height","viewBox","fill","stroke","strokeWidth","strokeLinecap","strokeLinejoin","Icon","forwardRef","color","size","absoluteStrokeWidth","iconNode","rest","ref","createElement","Number","map","tag","attrs","Array","isArray","createLucideIcon","iconName","Component","displayName","AdminChat","userId","theme","setTheme","open","setOpen","navOpen","setNavOpen","message","setMessage","attachments","setAttachments","sending","setSending","messages","setMessages","currentUserId","setCurrentUserId","menuRef","useRef","fileInputRef","chatEndRef","uid","_data$session","user","_data$session$user","id","log","getCurrentUserId","then","targetUserId","_session$session","_session$session$user2","from","select","or","order","ascending","length","fetchMessagesForUser","err","channel","onMessage","on","event","schema","table","payload","new","subscribe","subscribeToMessages","newMessage","prev","some","m","removeChannel","current","_chatEndRef$current","scrollIntoView","behavior","handleSend","senderId","recipientId","insert","sender_id","recipient_id","sendMessage","alert","handleClick","e","contains","target","document","addEventListener","removeEventListener","onClick","style","background","border","cursor","msg","isOutbound","Date","created_at","toLocaleTimeString","hour","minute","_fileInputRef$current","click","type","multiple","onChange","files","newFiles","display","value","placeholder","onKeyDown","shiftKey","preventDefault","disabled","borderRadius","padding","fontWeight","opacity","alignItems","gap","location","window","useMemo","pathname","parts","split","ProtectedRoute","textAlign"],"sourceRoot":""}