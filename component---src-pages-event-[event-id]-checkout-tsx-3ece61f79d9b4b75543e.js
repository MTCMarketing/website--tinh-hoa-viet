"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[6861],{6723:function(e,t,n){n.r(t);var a=n(6540),l=n(3),o=n(6459),r=n(6898);const s={EN:{brandTitle:"TINH HOA VI·ªÜT",tagline:"Where Vietnamese Excellence Meets Global Recognition",features:["Exclusive Gala Event","Cultural Performances","Networking with Honorees"],title:"Event Ticket Payment",subtitle:"Complete your payment to confirm your attendance",eventName:"Vietnamese Excellence Gala 2025",date:"December 10, 2025 ‚Äì 7:00 PM",location:"Saigon Opera House, Ho Chi Minh City",price:"Ticket Price: 500,000‚Ç´",payBtn:"Pay Now",loading:"Processing payment...",success:"Payment Confirmed! Thank you.",testBtn:"Test Pay",langEN:"EN",langVN:"VN"},VN:{brandTitle:"TINH HOA VI·ªÜT",tagline:"N∆°i t√¥n vinh tinh hoa Vi·ªát Nam v∆∞∆°n t·∫ßm qu·ªëc t·∫ø",features:["S·ª± ki·ªán Gala ƒë·ªôc quy·ªÅn","Bi·ªÉu di·ªÖn vƒÉn h√≥a","K·∫øt n·ªëi c√πng c√°c tinh hoa"],title:"Thanh To√°n V√© S·ª± Ki·ªán",subtitle:"Ho√†n t·∫•t thanh to√°n ƒë·ªÉ x√°c nh·∫≠n tham d·ª±",eventName:"Gala Tinh Hoa Vi·ªát 2025",date:"10/12/2025 ‚Äì 19:00",location:"Nh√† h√°t Th√†nh ph·ªë, TP. H·ªì Ch√≠ Minh",price:"Gi√° v√©: 500,000‚Ç´",payBtn:"Thanh to√°n ngay",loading:"ƒêang x·ª≠ l√Ω thanh to√°n...",success:"Thanh to√°n th√†nh c√¥ng! C·∫£m ∆°n b·∫°n.",testBtn:"Ki·ªÉm tra thanh to√°n (Portal)",langEN:"EN",langVN:"VN"}};t.default=()=>{const{0:e,1:t}=(0,a.useState)("EN"),{0:n,1:c}=(0,a.useState)(!1),{0:i,1:m}=(0,a.useState)(!1),{0:u,1:d}=(0,a.useState)(null),{0:g,1:h}=(0,a.useState)(null),{0:p,1:y}=(0,a.useState)(null),{0:N,1:E}=(0,a.useState)(!1),f=s[e];(0,a.useEffect)(()=>{r.ND.auth.getUser().then(e=>{let{data:t}=e;null!=t&&t.user?(d(t.user),console.log("‚úÖ Logged in as "+t.user.email+" ("+t.user.id+")")):console.log("‚ùå No user logged in")})},[]),(0,a.useEffect)(()=>{if(!u)return;console.log("üëÇ Setting up realtime listener for VietQR callbacks...");const e=r.ND.channel("public:messages").on("postgres_changes",{event:"INSERT",schema:"public",table:"messages"},e=>{try{const{event_type:n,payload:a}=e.new;if("vietqr_callback"===n){var t;const e=null!==(t=null==a?void 0:a.orderId)&&void 0!==t?t:"";if(console.log("üîç Checking callback..."),console.log("‚û°Ô∏è orderId:",e),console.log("‚û°Ô∏è current user:",u.id),!e)return void console.warn("‚ö†Ô∏è Missing orderId; ignoring.");if(e!==u.id)return void console.warn("‚ö†Ô∏è orderId does not match current user.");console.log("‚úÖ Matched callback for current user!"),console.log("üì¶ Payload:",JSON.stringify(a,null,2)),m(!0),h(null),y(a.transactionid||null)}}catch(n){console.error("‚ö†Ô∏è Error parsing payload:",n)}}).subscribe(e=>console.log("üì° Channel status: "+e));return()=>{console.log("üßπ Unsubscribing from realtime listener..."),r.ND.removeChannel(e)}},[u]);return a.createElement("div",{className:"auth-shell"},a.createElement("aside",{className:"brand-side"},a.createElement("div",{className:"brand-sheen"}),a.createElement("div",{className:"brand-pattern"}),a.createElement("div",{className:"brand-wrap"},a.createElement("h1",{className:"brand-name"},f.brandTitle),a.createElement("p",{className:"brand-tag"},f.tagline),a.createElement("ul",{className:"brand-features"},f.features.map((e,t)=>a.createElement("li",{key:t,className:"feature"},a.createElement("span",{className:"tick"},"‚úì"),a.createElement("span",null,e)))))),a.createElement("main",{className:"form-side"},a.createElement("header",{className:"form-top"},a.createElement("div",{className:"lang-switch"},a.createElement("button",{className:"lang "+("EN"===e?"active":""),onClick:()=>t("EN")},f.langEN),a.createElement("span",{className:"mid"},"|"),a.createElement("button",{className:"lang "+("VN"===e?"active":""),onClick:()=>t("VN")},f.langVN))),a.createElement("section",{className:"form-wrap",style:{color:"var(--ink)"}},a.createElement("div",{className:"intro"},a.createElement("h2",{className:"title"},f.title),a.createElement("p",{className:"subtitle"},f.subtitle)),a.createElement("div",{className:"auth-form",style:{textAlign:"center",color:"var(--ink)"}},a.createElement("div",{className:"field"},a.createElement("h3",{style:{color:"var(--gold-2)",fontSize:22,marginBottom:6}},f.eventName),a.createElement("p",null,f.date),a.createElement("p",null,f.location),a.createElement("p",{style:{fontWeight:700,marginTop:10}},f.price)),i?a.createElement("div",{style:{marginTop:20,color:"var(--gold-2)",fontWeight:700,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",gap:6}},a.createElement("div",{style:{display:"flex",alignItems:"center",gap:8}},a.createElement(l.A3x,{size:22}),f.success),p&&a.createElement("p",{style:{color:"var(--ink)",marginTop:4}},"Transaction ID: ",a.createElement("strong",null,p))):a.createElement(a.Fragment,null,g&&(g.qrDataURL||g.qrCode)&&a.createElement("div",{style:{marginTop:20}},a.createElement(o.X,{value:g.qrDataURL||g.qrCode,size:220,bgColor:"#ffffff",fgColor:"#000000",includeMargin:!0}),a.createElement("p",{style:{marginTop:12,color:"var(--gold-2)"}},"Scan this code to complete your payment.")),g?a.createElement("button",{className:"cta",onClick:async()=>{if(!g)return void alert("No QR data available.");const e={bankAccount:g.bankAccount||"0369053640",content:g.content||"TestPayment",amount:g.amount||15e4,bankCode:g.bankCode||"MB",transType:"C"};console.log("üßæ Sending payload2:",e),E(!0);try{const t=await fetch("https://integrations.tinhhoaviet.org.vn/vietqr/test-success",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}),n=await t.text();console.log("‚úÖ Response from test-success:",n)}catch(t){console.error("‚ùå Failed to post to /vietqr/test-success:",t)}finally{E(!1)}},disabled:N,style:{backgroundColor:"#00b37a",marginTop:10,opacity:N?.7:1,display:"flex",alignItems:"center",justifyContent:"center",fontWeight:600}},N?"‚è≥":f.testBtn):a.createElement("button",{className:"cta",onClick:async()=>{if(!u)return void alert("Please log in first.");try{c(!0),console.log("üí≥ Initiating payment for user:",u.id);const e=await fetch("https://integrations.tinhhoaviet.org.vn/vietqr/payment-intent",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({user_id:u.id})});if(!e.ok)throw new Error("Payment request failed.");const t=await e.json();console.log("üí≥ VietQR API Response:",t),t.qrLink||t.qrDataURL||t.qrCode?h(t):alert("Payment QR/link not received.")}catch(e){console.error("‚ùå Payment Error:",e),alert("An error occurred while initiating payment.")}finally{c(!1)}},disabled:n||!u,style:{opacity:n||!u?.6:1,cursor:u?"pointer":"not-allowed"}},a.createElement("span",null,u?n?f.loading:f.payBtn:"Login required"),!n&&u&&a.createElement(l.dyV,{className:"arrow"})))))))}}}]);
//# sourceMappingURL=component---src-pages-event-[event-id]-checkout-tsx-3ece61f79d9b4b75543e.js.map